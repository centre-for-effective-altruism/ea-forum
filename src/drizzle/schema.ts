import "server-only";
import { sql } from "drizzle-orm";
import {
  pgTable,
  index,
  uniqueIndex,
  unique,
  varchar,
  timestamp as rawTimestamp,
  text,
  jsonb,
  integer,
  doublePrecision,
  boolean,
} from "drizzle-orm/pg-core";

// TODO: Add users table - the drizzle parser chokes on the JSON default values

const timestamp = () => rawTimestamp({ withTimezone: true, mode: "string" });
const timestampDefaultNow = () => timestamp().default(sql`CURRENT_TIMESTAMP`);

const universalFields = {
  schemaVersion: doublePrecision().default(1),
  createdAt: timestampDefaultNow().notNull(),
  legacyData: jsonb(),
};

export const bans = pgTable(
  "Bans",
  {
    ...universalFields,
    id: varchar("_id", { length: 27 }).primaryKey().notNull(),
    expirationDate: timestamp(),
    userId: varchar({ length: 27 }).notNull(),
    ip: text(),
    reason: text(),
    comment: text().default("").notNull(),
    properties: jsonb(),
  },
  (table) => [
    index("idx_Bans_ip").using("btree", table.ip.asc().nullsLast().op("text_ops")),
    index("idx_Bans_schemaVersion").using(
      "btree",
      table.schemaVersion.asc().nullsLast().op("float8_ops"),
    ),
  ],
);

export const bookmarks = pgTable(
  "Bookmarks",
  {
    ...universalFields,
    id: varchar("_id", { length: 27 }).primaryKey().notNull(),
    documentId: text().notNull(),
    collectionName: text().notNull(),
    userId: varchar({ length: 27 }).notNull(),
    lastUpdated: timestamp().notNull(),
    active: boolean().default(false).notNull(),
  },
  (table) => [
    index("idx_Bookmarks_userId_active_lastUpdated").using(
      "btree",
      table.userId.asc().nullsLast().op("bool_ops"),
      table.active.asc().nullsLast().op("text_ops"),
      table.lastUpdated.asc().nullsLast().op("timestamptz_ops"),
    ),
    uniqueIndex("idx_Bookmarks_userId_documentId_collectionName").using(
      "btree",
      table.userId.asc().nullsLast().op("text_ops"),
      table.documentId.asc().nullsLast().op("text_ops"),
      table.collectionName.asc().nullsLast().op("text_ops"),
    ),
  ],
);

export const chapters = pgTable(
  "Chapters",
  {
    ...universalFields,
    id: varchar("_id", { length: 27 }).primaryKey().notNull(),
    title: text(),
    subtitle: text(),
    number: doublePrecision(),
    sequenceId: varchar({ length: 27 }),
    postIds: varchar({ length: 27 }).array().default([""]).notNull(),
    contents: jsonb(),
    contentsLatest: text("contents_latest"),
  },
  (table) => [
    index("idx_Chapters_schemaVersion").using(
      "btree",
      table.schemaVersion.asc().nullsLast().op("float8_ops"),
    ),
    index("idx_Chapters_sequenceId_number").using(
      "btree",
      table.sequenceId.asc().nullsLast().op("float8_ops"),
      table.number.asc().nullsLast().op("float8_ops"),
    ),
  ],
);

export const books = pgTable(
  "Books",
  {
    ...universalFields,
    id: varchar("_id", { length: 27 }).primaryKey().notNull(),
    postedAt: timestamp(),
    title: text(),
    subtitle: text(),
    collectionId: varchar({ length: 27 }).notNull(),
    number: doublePrecision(),
    postIds: varchar({ length: 27 })
      .array()
      .default(["}'::character varying(2"])
      .notNull(),
    sequenceIds: varchar({ length: 27 })
      .array()
      .default(["}'::character varying(2"])
      .notNull(),
    displaySequencesAsGrid: boolean(),
    hideProgressBar: boolean(),
    showChapters: boolean(),
    contents: jsonb(),
    contentsLatest: text("contents_latest"),
    tocTitle: text(),
  },
  (table) => [
    index("idx_Books_collectionId").using(
      "btree",
      table.collectionId.asc().nullsLast().op("text_ops"),
    ),
    index("idx_Books_schemaVersion").using(
      "btree",
      table.schemaVersion.asc().nullsLast().op("float8_ops"),
    ),
  ],
);

export const ckEditorUserSessions = pgTable(
  "CkEditorUserSessions",
  {
    ...universalFields,
    id: varchar("_id", { length: 27 }).primaryKey().notNull(),
    documentId: text().notNull(),
    userId: text().notNull(),
    endedAt: timestamp(),
    endedBy: text(),
  },
  (table) => [
    index("idx_CkEditorUserSessions_documentId_userId").using(
      "btree",
      table.documentId.asc().nullsLast().op("text_ops"),
      table.userId.asc().nullsLast().op("text_ops"),
    ),
    index("idx_CkEditorUserSessions_schemaVersion").using(
      "btree",
      table.schemaVersion.asc().nullsLast().op("float8_ops"),
    ),
  ],
);

export const collections = pgTable(
  "Collections",
  {
    ...universalFields,
    id: varchar("_id", { length: 27 }).primaryKey().notNull(),
    userId: varchar({ length: 27 }).notNull(),
    title: text().notNull(),
    slug: text().notNull(),
    gridImageId: text(),
    firstPageLink: text().notNull(),
    hideStartReadingButton: boolean(),
    contents: jsonb(),
    contentsLatest: text("contents_latest"),
    noindex: boolean().default(false).notNull(),
  },
  (table) => [
    index("idx_Collections_schemaVersion").using(
      "btree",
      table.schemaVersion.asc().nullsLast().op("float8_ops"),
    ),
    index("idx_Collections_slug").using(
      "btree",
      table.slug.asc().nullsLast().op("text_ops"),
    ),
  ],
);

export const comments = pgTable(
  "Comments",
  {
    ...universalFields,
    id: varchar("_id", { length: 27 }).primaryKey().notNull(),
    parentCommentId: varchar({ length: 27 }),
    topLevelCommentId: varchar({ length: 27 }),
    postedAt: timestamp().notNull(),
    author: text(),
    postId: varchar({ length: 27 }),
    tagId: varchar({ length: 27 }),
    tagCommentType: text().default("DISCUSSION").notNull(),
    subforumStickyPriority: doublePrecision(),
    userId: varchar({ length: 27 }).notNull(),
    userIp: text(),
    userAgent: text(),
    referrer: text(),
    authorIsUnreviewed: boolean().default(false).notNull(),
    answer: boolean().default(false).notNull(),
    parentAnswerId: varchar({ length: 27 }),
    directChildrenCount: doublePrecision().default(0).notNull(),
    descendentCount: doublePrecision().default(0).notNull(),
    shortform: boolean(),
    nominatedForReview: text(),
    reviewingForReview: text(),
    lastSubthreadActivity: timestamp(),
    postVersion: text(),
    promoted: boolean(),
    promotedByUserId: varchar({ length: 27 }),
    promotedAt: timestamp(),
    hideKarma: boolean(),
    legacy: boolean().default(false).notNull(),
    legacyId: text(),
    legacyPoll: boolean().default(false).notNull(),
    legacyParentId: text(),
    retracted: boolean().default(false).notNull(),
    deleted: boolean().default(false).notNull(),
    deletedPublic: boolean().default(false).notNull(),
    deletedReason: text(),
    deletedDate: timestamp(),
    deletedByUserId: varchar({ length: 27 }),
    spam: boolean().default(false).notNull(),
    repliesBlockedUntil: timestamp(),
    needsReview: boolean(),
    reviewedByUserId: varchar({ length: 27 }),
    hideAuthor: boolean().default(false).notNull(),
    moderatorHat: boolean().default(false).notNull(),
    hideModeratorHat: boolean(),
    isPinnedOnProfile: boolean().default(false).notNull(),
    title: varchar({ length: 500 }),
    af: boolean().default(false).notNull(),
    suggestForAlignmentUserIds: text().array().default([""]).notNull(),
    reviewForAlignmentUserId: text(),
    afDate: timestamp(),
    moveToAlignmentUserId: varchar({ length: 27 }),
    agentFoundationsId: text(),
    schemaVersion: doublePrecision().default(1),
    createdAt: timestampDefaultNow(),
    legacyData: jsonb(),
    contents: jsonb(),
    contentsLatest: text("contents_latest"),
    voteCount: doublePrecision().default(0).notNull(),
    baseScore: doublePrecision().default(0).notNull(),
    extendedScore: jsonb(),
    score: doublePrecision().default(0).notNull(),
    inactive: boolean().default(false).notNull(),
    afBaseScore: doublePrecision(),
    afExtendedScore: jsonb(),
    afVoteCount: doublePrecision(),
    pingbacks: jsonb(),
    relevantTagIds: varchar({ length: 27 })
      .array()
      .default(["'{}'::VARCHAR[]"])
      .notNull(),
    debateResponse: boolean(),
    rejected: boolean().default(false).notNull(),
    rejectedByUserId: varchar({ length: 27 }),
    modGptAnalysis: text(),
    modGptRecommendation: text(),
    rejectedReason: text(),
    shortformFrontpage: boolean().default(true).notNull(),
    originalDialogueId: varchar({ length: 27 }),
    forumEventId: varchar({ length: 27 }),
    forumEventMetadata: jsonb(),
    lastEditedAt: timestamp(),
    draft: boolean().default(false).notNull(),
  },
  (table) => [
    index("comments_shortform_recent_discussions_idx")
      .using(
        "btree",
        sql`COALESCE("topLevelCommentId", _id)`,
        sql`lastSubthreadActivity`,
      )
      .where(sql`(shortform IS TRUE)`),
    index("idx_Comments_agentFoundationsId").using(
      "btree",
      table.agentFoundationsId.asc().nullsLast().op("text_ops"),
    ),
    index("idx_Comments_inactive_postedAt").using(
      "btree",
      table.inactive.asc().nullsLast().op("bool_ops"),
      table.postedAt.asc().nullsLast().op("timestamptz_ops"),
    ),
    index("idx_Comments_isPinnedOnProfile_postedAt_authorIsUnreviewed_dele").using(
      "btree",
      table.isPinnedOnProfile.asc().nullsLast().op("bool_ops"),
      table.postedAt.asc().nullsLast().op("bool_ops"),
      table.authorIsUnreviewed.asc().nullsLast().op("bool_ops"),
      table.deleted.asc().nullsLast().op("bool_ops"),
      table.deletedPublic.asc().nullsLast().op("bool_ops"),
      table.hideAuthor.asc().nullsLast().op("bool_ops"),
      table.userId.asc().nullsLast().op("bool_ops"),
      table.af.asc().nullsLast().op("bool_ops"),
    ),
    index("idx_Comments_legacyId").using(
      "btree",
      table.legacyId.asc().nullsLast().op("text_ops"),
    ),
    index("idx_Comments_parentAnswerId_baseScore_authorIsUnreviewed_delete").using(
      "btree",
      table.parentAnswerId.asc().nullsLast().op("bool_ops"),
      table.baseScore.asc().nullsLast().op("float8_ops"),
      table.authorIsUnreviewed.asc().nullsLast().op("text_ops"),
      table.deleted.asc().nullsLast().op("bool_ops"),
      table.deletedPublic.asc().nullsLast().op("bool_ops"),
      table.hideAuthor.asc().nullsLast().op("float8_ops"),
      table.userId.asc().nullsLast().op("bool_ops"),
      table.af.asc().nullsLast().op("text_ops"),
    ),
    index("idx_Comments_parentCommentId").using(
      "btree",
      table.parentCommentId.asc().nullsLast().op("text_ops"),
    ),
    index("idx_Comments_postId").using(
      "btree",
      table.postId.asc().nullsLast().op("text_ops"),
    ),
    index("idx_Comments_postId_promotedAt")
      .using(
        "btree",
        table.postId.asc().nullsLast().op("text_ops"),
        table.promotedAt.asc().nullsLast().op("text_ops"),
      )
      .where(sql`("promotedAt" IS NOT NULL)`),
    index("idx_Comments_postedAt_authorIsUnreviewed_deleted_deletedPublic_").using(
      "btree",
      table.postedAt.asc().nullsLast().op("text_ops"),
      table.authorIsUnreviewed.asc().nullsLast().op("text_ops"),
      table.deleted.asc().nullsLast().op("bool_ops"),
      table.deletedPublic.asc().nullsLast().op("text_ops"),
      table.hideAuthor.asc().nullsLast().op("bool_ops"),
      table.userId.asc().nullsLast().op("text_ops"),
      table.af.asc().nullsLast().op("text_ops"),
    ),
    index("idx_Comments_rejected_authorIsUnreviewed_postedAt_deleted_delet").using(
      "btree",
      table.rejected.asc().nullsLast().op("text_ops"),
      table.authorIsUnreviewed.asc().nullsLast().op("text_ops"),
      table.postedAt.asc().nullsLast().op("text_ops"),
      table.deleted.asc().nullsLast().op("bool_ops"),
      table.deletedPublic.asc().nullsLast().op("bool_ops"),
      table.hideAuthor.asc().nullsLast().op("timestamptz_ops"),
      table.userId.asc().nullsLast().op("text_ops"),
      table.af.asc().nullsLast().op("text_ops"),
      table.debateResponse.asc().nullsLast().op("text_ops"),
    ),
    index("idx_Comments_schemaVersion").using(
      "btree",
      table.schemaVersion.asc().nullsLast().op("float8_ops"),
    ),
    index("idx_Comments_shortform_topLevelCommentId_lastSubthreadActivity_").using(
      "btree",
      table.shortform.asc().nullsLast().op("bool_ops"),
      table.topLevelCommentId.asc().nullsLast().op("timestamptz_ops"),
      table.lastSubthreadActivity.asc().nullsLast().op("bool_ops"),
      table.postedAt.asc().nullsLast().op("bool_ops"),
      table.baseScore.asc().nullsLast().op("timestamptz_ops"),
    ),
    index("idx_Comments_suggestForAlignmentUserIds")
      .using(
        "btree",
        table.reviewForAlignmentUserId.asc().nullsLast().op("bool_ops"),
        table.af.asc().nullsLast().op("timestamptz_ops"),
        table.postedAt.asc().nullsLast().op("text_ops"),
      )
      .where(sql`("suggestForAlignmentUserIds" IS DISTINCT FROM '{}'::text[])`)
      .with({ deduplicate_items: "true" }),
    index("idx_Comments_topLevelCommentId").using(
      "btree",
      table.topLevelCommentId.asc().nullsLast().op("text_ops"),
    ),
    index("idx_Comments_topLevelCommentId_postedAt_baseScore").using(
      "btree",
      table.topLevelCommentId.asc().nullsLast().op("timestamptz_ops"),
      table.postedAt.asc().nullsLast().op("timestamptz_ops"),
      table.baseScore.asc().nullsLast().op("float8_ops"),
    ),
    index("idx_Comments_topLevelCommentId_tagCommentType_tagId_authorIsUnr").using(
      "btree",
      table.topLevelCommentId.asc().nullsLast().op("bool_ops"),
      table.tagCommentType.asc().nullsLast().op("bool_ops"),
      table.tagId.asc().nullsLast().op("text_ops"),
      table.authorIsUnreviewed.asc().nullsLast().op("text_ops"),
      table.deleted.asc().nullsLast().op("bool_ops"),
      table.deletedPublic.asc().nullsLast().op("bool_ops"),
      table.hideAuthor.asc().nullsLast().op("bool_ops"),
      table.userId.asc().nullsLast().op("bool_ops"),
      table.af.asc().nullsLast().op("bool_ops"),
    ),
    index("idx_Comments_userId_createdAt").using(
      "btree",
      table.userId.asc().nullsLast().op("timestamptz_ops"),
      table.createdAt.asc().nullsLast().op("text_ops"),
    ),
    index("idx_Comments_userId_isPinnedOnProfile_postedAt_authorIsUnreview").using(
      "btree",
      table.userId.asc().nullsLast().op("timestamptz_ops"),
      table.isPinnedOnProfile.asc().nullsLast().op("timestamptz_ops"),
      table.postedAt.asc().nullsLast().op("bool_ops"),
      table.authorIsUnreviewed.asc().nullsLast().op("bool_ops"),
      table.deleted.asc().nullsLast().op("timestamptz_ops"),
      table.deletedPublic.asc().nullsLast().op("bool_ops"),
      table.hideAuthor.asc().nullsLast().op("bool_ops"),
      table.af.asc().nullsLast().op("text_ops"),
      table.debateResponse.asc().nullsLast().op("text_ops"),
    ),
    index("idx_Comments_userId_postId_postedAt").using(
      "btree",
      table.userId.asc().nullsLast().op("text_ops"),
      table.postId.asc().nullsLast().op("text_ops"),
      table.postedAt.asc().nullsLast().op("timestamptz_ops"),
    ),
    index("idx_Comments_userId_postedAt").using(
      "btree",
      table.userId.asc().nullsLast().op("text_ops"),
      table.postedAt.asc().nullsLast().op("timestamptz_ops"),
    ),
    index("idx_Comments_userId_postedAt_authorIsUnreviewed_deleted_deleted").using(
      "btree",
      table.userId.asc().nullsLast().op("timestamptz_ops"),
      table.postedAt.asc().nullsLast().op("timestamptz_ops"),
      table.authorIsUnreviewed.asc().nullsLast().op("bool_ops"),
      table.deleted.asc().nullsLast().op("text_ops"),
      table.deletedPublic.asc().nullsLast().op("bool_ops"),
      table.hideAuthor.asc().nullsLast().op("bool_ops"),
      table.af.asc().nullsLast().op("timestamptz_ops"),
    ),
    index("idx_comments_af_top_comments").using(
      "btree",
      table.postId.asc().nullsLast().op("timestamptz_ops"),
      table.parentAnswerId.asc().nullsLast().op("float8_ops"),
      table.answer.asc().nullsLast().op("text_ops"),
      table.deleted.asc().nullsLast().op("timestamptz_ops"),
      table.afBaseScore.asc().nullsLast().op("float8_ops"),
      table.postedAt.asc().nullsLast().op("bool_ops"),
      table.authorIsUnreviewed.asc().nullsLast().op("text_ops"),
      table.deletedPublic.asc().nullsLast().op("timestamptz_ops"),
      table.hideAuthor.asc().nullsLast().op("float8_ops"),
      table.userId.asc().nullsLast().op("text_ops"),
      table.af.asc().nullsLast().op("text_ops"),
    ),
    index("idx_comments_agentFoundationsId").using(
      "btree",
      table.agentFoundationsId.asc().nullsLast().op("text_ops"),
    ),
    index("idx_comments_alignmentSuggestedComments")
      .using(
        "gin",
        table.reviewForAlignmentUserId.asc().nullsLast().op("array_ops"),
        table.af.asc().nullsLast().op("text_ops"),
        table.suggestForAlignmentUserIds.asc().nullsLast().op("text_ops"),
        table.postedAt.asc().nullsLast().op("text_ops"),
        table.authorIsUnreviewed.asc().nullsLast().op("timestamptz_ops"),
        table.deleted.asc().nullsLast().op("bool_ops"),
        table.deletedPublic.asc().nullsLast().op("varchar_ops"),
        table.hideAuthor.asc().nullsLast().op("varchar_ops"),
        table.userId.asc().nullsLast().op("timestamptz_ops"),
      )
      .where(sql`("suggestForAlignmentUserIds"[0] IS NOT NULL)`),
    index("idx_comments_forumEventId_userId_postedAt_authorIsUnreviewed_de").using(
      "btree",
      table.forumEventId.asc().nullsLast().op("timestamptz_ops"),
      table.userId.asc().nullsLast().op("text_ops"),
      table.postedAt.asc().nullsLast().op("text_ops"),
      table.authorIsUnreviewed.asc().nullsLast().op("text_ops"),
      table.deleted.asc().nullsLast().op("bool_ops"),
      table.deletedPublic.asc().nullsLast().op("bool_ops"),
      table.hideAuthor.asc().nullsLast().op("timestamptz_ops"),
      table.af.asc().nullsLast().op("text_ops"),
      table.debateResponse.asc().nullsLast().op("text_ops"),
    ),
    index("idx_comments_inactive_postedAt").using(
      "btree",
      table.inactive.asc().nullsLast().op("timestamptz_ops"),
      table.postedAt.asc().nullsLast().op("timestamptz_ops"),
    ),
    index("idx_comments_legacyId").using(
      "btree",
      table.legacyId.asc().nullsLast().op("text_ops"),
    ),
    index("idx_comments_magic_comments").using(
      "btree",
      table.postId.asc().nullsLast().op("timestamptz_ops"),
      table.parentAnswerId.asc().nullsLast().op("float8_ops"),
      table.answer.asc().nullsLast().op("float8_ops"),
      table.deleted.asc().nullsLast().op("text_ops"),
      table.score.asc().nullsLast().op("text_ops"),
      table.postedAt.asc().nullsLast().op("timestamptz_ops"),
      table.authorIsUnreviewed.asc().nullsLast().op("timestamptz_ops"),
      table.deletedPublic.asc().nullsLast().op("timestamptz_ops"),
      table.hideAuthor.asc().nullsLast().op("timestamptz_ops"),
      table.userId.asc().nullsLast().op("timestamptz_ops"),
      table.af.asc().nullsLast().op("bool_ops"),
      table.debateResponse.asc().nullsLast().op("text_ops"),
    ),
    index("idx_comments_moderatorHat").using(
      "btree",
      table.moderatorHat.asc().nullsLast().op("bool_ops"),
      table.authorIsUnreviewed.asc().nullsLast().op("text_ops"),
      table.deleted.asc().nullsLast().op("text_ops"),
      table.deletedPublic.asc().nullsLast().op("bool_ops"),
      table.hideAuthor.asc().nullsLast().op("text_ops"),
      table.userId.asc().nullsLast().op("bool_ops"),
      table.af.asc().nullsLast().op("text_ops"),
    ),
    index("idx_comments_new_comments").using(
      "btree",
      table.postId.asc().nullsLast().op("timestamptz_ops"),
      table.parentAnswerId.asc().nullsLast().op("timestamptz_ops"),
      table.answer.asc().nullsLast().op("timestamptz_ops"),
      table.deleted.asc().nullsLast().op("timestamptz_ops"),
      table.postedAt.asc().nullsLast().op("bool_ops"),
      table.authorIsUnreviewed.asc().nullsLast().op("text_ops"),
      table.deletedPublic.asc().nullsLast().op("bool_ops"),
      table.hideAuthor.asc().nullsLast().op("bool_ops"),
      table.userId.asc().nullsLast().op("text_ops"),
      table.af.asc().nullsLast().op("bool_ops"),
    ),
    index("idx_comments_nominations2018").using(
      "btree",
      table.nominatedForReview.asc().nullsLast().op("bool_ops"),
      table.userId.asc().nullsLast().op("text_ops"),
      table.postId.asc().nullsLast().op("bool_ops"),
      table.authorIsUnreviewed.asc().nullsLast().op("bool_ops"),
      table.deleted.asc().nullsLast().op("text_ops"),
      table.deletedPublic.asc().nullsLast().op("bool_ops"),
      table.hideAuthor.asc().nullsLast().op("bool_ops"),
      table.af.asc().nullsLast().op("text_ops"),
    ),
    index("idx_comments_parentAnswerId_baseScore_authorIsUnreviewed_delete").using(
      "btree",
      table.parentAnswerId.asc().nullsLast().op("float8_ops"),
      table.baseScore.asc().nullsLast().op("bool_ops"),
      table.authorIsUnreviewed.asc().nullsLast().op("bool_ops"),
      table.deleted.asc().nullsLast().op("bool_ops"),
      table.deletedPublic.asc().nullsLast().op("float8_ops"),
      table.hideAuthor.asc().nullsLast().op("timestamptz_ops"),
      table.userId.asc().nullsLast().op("float8_ops"),
      table.af.asc().nullsLast().op("float8_ops"),
      table.postedAt.asc().nullsLast().op("timestamptz_ops"),
      table.debateResponse.asc().nullsLast().op("timestamptz_ops"),
    ),
    index("idx_comments_parentCommentId").using(
      "btree",
      table.parentCommentId.asc().nullsLast().op("text_ops"),
    ),
    index("idx_comments_popular_comments")
      .using(
        "btree",
        table.postId.asc().nullsLast().op("float8_ops"),
        table.baseScore.desc().nullsFirst().op("float8_ops"),
        table.postedAt.desc().nullsFirst().op("float8_ops"),
      )
      .where(sql`("baseScore" >= (15)::double precision)`),
    index("idx_comments_postId").using(
      "btree",
      table.postId.asc().nullsLast().op("text_ops"),
    ),
    index("idx_comments_postedAt_authorIsUnreviewed_deleted_deletedPublic_").using(
      "btree",
      table.postedAt.asc().nullsLast().op("timestamptz_ops"),
      table.authorIsUnreviewed.asc().nullsLast().op("text_ops"),
      table.deleted.asc().nullsLast().op("bool_ops"),
      table.deletedPublic.asc().nullsLast().op("timestamptz_ops"),
      table.hideAuthor.asc().nullsLast().op("timestamptz_ops"),
      table.userId.asc().nullsLast().op("text_ops"),
      table.af.asc().nullsLast().op("text_ops"),
      table.debateResponse.asc().nullsLast().op("bool_ops"),
    ),
    index("idx_comments_recent_replies").using(
      "btree",
      table.postId.asc().nullsLast().op("float8_ops"),
      table.parentAnswerId.asc().nullsLast().op("float8_ops"),
      table.answer.asc().nullsLast().op("timestamptz_ops"),
      table.deleted.asc().nullsLast().op("bool_ops"),
      table.lastSubthreadActivity.asc().nullsLast().op("bool_ops"),
      table.baseScore.asc().nullsLast().op("timestamptz_ops"),
      table.postedAt.asc().nullsLast().op("bool_ops"),
      table.authorIsUnreviewed.asc().nullsLast().op("float8_ops"),
      table.deletedPublic.asc().nullsLast().op("text_ops"),
      table.hideAuthor.asc().nullsLast().op("text_ops"),
      table.userId.asc().nullsLast().op("timestamptz_ops"),
      table.af.asc().nullsLast().op("bool_ops"),
      table.debateResponse.asc().nullsLast().op("float8_ops"),
    ),
    index("idx_comments_rejected_authorIsUnreviewed_postedAt_deleted_delet").using(
      "btree",
      table.rejected.asc().nullsLast().op("timestamptz_ops"),
      table.authorIsUnreviewed.asc().nullsLast().op("text_ops"),
      table.postedAt.asc().nullsLast().op("text_ops"),
      table.deleted.asc().nullsLast().op("text_ops"),
      table.deletedPublic.asc().nullsLast().op("bool_ops"),
      table.hideAuthor.asc().nullsLast().op("timestamptz_ops"),
      table.userId.asc().nullsLast().op("timestamptz_ops"),
      table.af.asc().nullsLast().op("timestamptz_ops"),
      table.debateResponse.asc().nullsLast().op("timestamptz_ops"),
    ),
    index("idx_comments_reviews2018").using(
      "btree",
      table.reviewingForReview.asc().nullsLast().op("bool_ops"),
      table.userId.asc().nullsLast().op("bool_ops"),
      table.postId.asc().nullsLast().op("text_ops"),
      table.authorIsUnreviewed.asc().nullsLast().op("text_ops"),
      table.deleted.asc().nullsLast().op("bool_ops"),
      table.deletedPublic.asc().nullsLast().op("bool_ops"),
      table.hideAuthor.asc().nullsLast().op("text_ops"),
      table.af.asc().nullsLast().op("bool_ops"),
    ),
    index("idx_comments_schemaVersion").using(
      "btree",
      table.schemaVersion.asc().nullsLast().op("float8_ops"),
    ),
    index("idx_comments_shortform_topLevelCommentId_lastSubthreadActivity_").using(
      "btree",
      table.shortform.asc().nullsLast().op("bool_ops"),
      table.topLevelCommentId.asc().nullsLast().op("timestamptz_ops"),
      table.lastSubthreadActivity.asc().nullsLast().op("float8_ops"),
      table.postedAt.asc().nullsLast().op("float8_ops"),
      table.baseScore.asc().nullsLast().op("timestamptz_ops"),
    ),
    index("idx_comments_tagId").using(
      "btree",
      table.tagId.asc().nullsLast().op("bool_ops"),
      table.authorIsUnreviewed.asc().nullsLast().op("text_ops"),
      table.deleted.asc().nullsLast().op("text_ops"),
      table.deletedPublic.asc().nullsLast().op("bool_ops"),
      table.hideAuthor.asc().nullsLast().op("text_ops"),
      table.userId.asc().nullsLast().op("text_ops"),
      table.af.asc().nullsLast().op("bool_ops"),
    ),
    index("idx_comments_topLevelCommentId").using(
      "btree",
      table.topLevelCommentId.asc().nullsLast().op("text_ops"),
    ),
    index("idx_comments_topLevelCommentId_postedAt_baseScore").using(
      "btree",
      table.topLevelCommentId.asc().nullsLast().op("text_ops"),
      table.postedAt.asc().nullsLast().op("text_ops"),
      table.baseScore.asc().nullsLast().op("text_ops"),
    ),
    index("idx_comments_topLevelCommentId_tagCommentType_tagId_authorIsUnr").using(
      "btree",
      table.topLevelCommentId.asc().nullsLast().op("text_ops"),
      table.tagCommentType.asc().nullsLast().op("text_ops"),
      table.tagId.asc().nullsLast().op("text_ops"),
      table.authorIsUnreviewed.asc().nullsLast().op("text_ops"),
      table.deleted.asc().nullsLast().op("text_ops"),
      table.deletedPublic.asc().nullsLast().op("text_ops"),
      table.hideAuthor.asc().nullsLast().op("bool_ops"),
      table.userId.asc().nullsLast().op("timestamptz_ops"),
      table.af.asc().nullsLast().op("timestamptz_ops"),
      table.postedAt.asc().nullsLast().op("timestamptz_ops"),
      table.debateResponse.asc().nullsLast().op("bool_ops"),
    ),
    index("idx_comments_top_comments").using(
      "btree",
      table.postId.asc().nullsLast().op("text_ops"),
      table.parentAnswerId.asc().nullsLast().op("text_ops"),
      table.answer.asc().nullsLast().op("timestamptz_ops"),
      table.deleted.asc().nullsLast().op("bool_ops"),
      table.baseScore.asc().nullsLast().op("bool_ops"),
      table.postedAt.asc().nullsLast().op("timestamptz_ops"),
      table.authorIsUnreviewed.asc().nullsLast().op("timestamptz_ops"),
      table.deletedPublic.asc().nullsLast().op("float8_ops"),
      table.hideAuthor.asc().nullsLast().op("text_ops"),
      table.userId.asc().nullsLast().op("float8_ops"),
      table.af.asc().nullsLast().op("timestamptz_ops"),
    ),
    index("idx_comments_userId_createdAt").using(
      "btree",
      table.userId.asc().nullsLast().op("timestamptz_ops"),
      table.createdAt.asc().nullsLast().op("timestamptz_ops"),
    ),
    index("idx_comments_userId_isPinnedOnProfile_postedAt_authorIsUnreview").using(
      "btree",
      table.userId.asc().nullsLast().op("text_ops"),
      table.isPinnedOnProfile.asc().nullsLast().op("text_ops"),
      table.postedAt.asc().nullsLast().op("timestamptz_ops"),
      table.authorIsUnreviewed.asc().nullsLast().op("bool_ops"),
      table.deleted.asc().nullsLast().op("bool_ops"),
      table.deletedPublic.asc().nullsLast().op("text_ops"),
      table.hideAuthor.asc().nullsLast().op("bool_ops"),
      table.af.asc().nullsLast().op("bool_ops"),
      table.debateResponse.asc().nullsLast().op("text_ops"),
    ),
    index("idx_comments_userId_postedAt").using(
      "btree",
      table.userId.asc().nullsLast().op("text_ops"),
      table.postedAt.asc().nullsLast().op("timestamptz_ops"),
    ),
    index("idx_comments_userId_postedAt_authorIsUnreviewed_deleted_deleted").using(
      "btree",
      table.userId.asc().nullsLast().op("text_ops"),
      table.postedAt.asc().nullsLast().op("timestamptz_ops"),
      table.authorIsUnreviewed.asc().nullsLast().op("timestamptz_ops"),
      table.deleted.asc().nullsLast().op("bool_ops"),
      table.deletedPublic.asc().nullsLast().op("bool_ops"),
      table.hideAuthor.asc().nullsLast().op("bool_ops"),
      table.af.asc().nullsLast().op("timestamptz_ops"),
      table.debateResponse.asc().nullsLast().op("bool_ops"),
    ),
  ],
);

export const clientIds = pgTable(
  "ClientIds",
  {
    ...universalFields,
    id: varchar("_id", { length: 27 }).primaryKey().notNull(),
    clientId: text().notNull(),
    firstSeenReferrer: text(),
    firstSeenLandingPage: text(),
    userIds: text().array().default([""]),
    invalidated: boolean().default(false).notNull(),
    lastSeenAt: timestamp(),
    timesSeen: doublePrecision().default(1).notNull(),
  },
  (table) => [
    index("idx_ClientIds_clientId").using(
      "btree",
      table.clientId.asc().nullsLast().op("text_ops"),
    ),
    index("idx_ClientIds_createdAt").using(
      "btree",
      table.createdAt.asc().nullsLast().op("timestamptz_ops"),
    ),
    index("idx_ClientIds_schemaVersion").using(
      "btree",
      table.schemaVersion.asc().nullsLast().op("float8_ops"),
    ),
    index("idx_ClientIds_userIds").using(
      "gin",
      table.userIds.asc().nullsLast().op("array_ops"),
    ),
    uniqueIndex("idx_idx_ClientIds_clientId_unique").using(
      "btree",
      table.clientId.asc().nullsLast().op("text_ops"),
    ),
  ],
);

export const commentModeratorActions = pgTable(
  "CommentModeratorActions",
  {
    ...universalFields,
    id: varchar("_id", { length: 27 }).primaryKey().notNull(),
    commentId: varchar({ length: 27 }).notNull(),
    type: text().notNull(),
    endedAt: timestamp(),
  },
  (table) => [
    index("idx_CommentModeratorActions_commentId_createdAt").using(
      "btree",
      table.commentId.asc().nullsLast().op("text_ops"),
      table.createdAt.asc().nullsLast().op("text_ops"),
    ),
    index("idx_CommentModeratorActions_schemaVersion").using(
      "btree",
      table.schemaVersion.asc().nullsLast().op("float8_ops"),
    ),
  ],
);

export const databaseMetadata = pgTable(
  "DatabaseMetadata",
  {
    ...universalFields,
    id: varchar("_id", { length: 27 }).primaryKey().notNull(),
    name: text().notNull(),
    value: jsonb().notNull(),
  },
  (table) => [
    uniqueIndex("idx_DatabaseMetadata_name").using(
      "btree",
      table.name.asc().nullsLast().op("text_ops"),
    ),
    index("idx_DatabaseMetadata_schemaVersion").using(
      "btree",
      table.schemaVersion.asc().nullsLast().op("float8_ops"),
    ),
  ],
);

export const digestPosts = pgTable(
  "DigestPosts",
  {
    ...universalFields,
    id: varchar("_id", { length: 27 }).primaryKey().notNull(),
    digestId: varchar({ length: 27 }).notNull(),
    postId: varchar({ length: 27 }).notNull(),
    emailDigestStatus: text(),
    onsiteDigestStatus: text(),
  },
  (table) => [
    index("idx_DigestPosts_digestId").using(
      "btree",
      table.digestId.asc().nullsLast().op("text_ops"),
    ),
    index("idx_DigestPosts_schemaVersion").using(
      "btree",
      table.schemaVersion.asc().nullsLast().op("float8_ops"),
    ),
  ],
);

export const curationNotices = pgTable(
  "CurationNotices",
  {
    ...universalFields,
    id: varchar("_id", { length: 27 }).primaryKey().notNull(),
    userId: varchar({ length: 27 }).notNull(),
    commentId: varchar({ length: 27 }),
    postId: varchar({ length: 27 }),
    deleted: boolean().default(false).notNull(),
    contents: jsonb(),
    contentsLatest: text("contents_latest"),
  },
  (table) => [
    index("idx_CurationNotices_schemaVersion").using(
      "btree",
      table.schemaVersion.asc().nullsLast().op("float8_ops"),
    ),
  ],
);

export const electionCandidates = pgTable(
  "ElectionCandidates",
  {
    ...universalFields,
    id: varchar("_id", { length: 27 }).primaryKey().notNull(),
    electionName: text().notNull(),
    name: text().notNull(),
    logoSrc: text().notNull(),
    href: text().notNull(),
    description: text().notNull(),
    userId: varchar({ length: 27 }).notNull(),
    postCount: doublePrecision().default(0).notNull(),
    voteCount: doublePrecision().default(0).notNull(),
    baseScore: doublePrecision().default(0).notNull(),
    extendedScore: jsonb(),
    score: doublePrecision().default(0).notNull(),
    inactive: boolean().default(false).notNull(),
    afBaseScore: doublePrecision(),
    afExtendedScore: jsonb(),
    afVoteCount: doublePrecision(),
    tagId: varchar({ length: 27 }).notNull(),
    fundraiserLink: text(),
    gwwcLink: text(),
    gwwcId: text(),
    amountRaised: doublePrecision(),
    targetAmount: doublePrecision(),
    isElectionFundraiser: boolean().default(false).notNull(),
  },
  (table) => [
    index("idx_ElectionCandidates_electionName").using(
      "btree",
      table.electionName.asc().nullsLast().op("text_ops"),
    ),
    index("idx_ElectionCandidates_schemaVersion").using(
      "btree",
      table.schemaVersion.asc().nullsLast().op("float8_ops"),
    ),
  ],
);

export const digests = pgTable(
  "Digests",
  {
    ...universalFields,
    id: varchar("_id", { length: 27 }).primaryKey().notNull(),
    num: doublePrecision().notNull(),
    startDate: timestamp().notNull(),
    endDate: timestamp(),
    publishedDate: timestamp(),
    onsiteImageId: text(),
    onsitePrimaryColor: text(),
    postId: varchar({ length: 27 }),
  },
  (table) => [
    index("idx_Digests_num").using(
      "btree",
      table.num.asc().nullsLast().op("float8_ops"),
    ),
    index("idx_Digests_schemaVersion").using(
      "btree",
      table.schemaVersion.asc().nullsLast().op("float8_ops"),
    ),
  ],
);

export const conversations = pgTable(
  "Conversations",
  {
    ...universalFields,
    id: varchar("_id", { length: 27 }).primaryKey().notNull(),
    title: text(),
    participantIds: varchar({ length: 27 })
      .array()
      .default(["'{}'::VARCHAR[]"])
      .notNull(),
    latestActivity: timestamp(),
    af: boolean(),
    messageCount: doublePrecision().default(0).notNull(),
    moderator: boolean(),
    archivedByIds: varchar({ length: 27 })
      .array()
      .default(["}'::character varying(2"])
      .notNull(),
  },
  (table) => [
    index("idx_Conversations_moderator_messageCount_latestActivity_partici").using(
      "gin",
      table.moderator.asc().nullsLast().op("array_ops"),
      table.messageCount.asc().nullsLast().op("array_ops"),
      table.latestActivity.asc().nullsLast().op("array_ops"),
      table.participantIds.asc().nullsLast().op("array_ops"),
    ),
    index("idx_Conversations_participantIds_messageCount_latestActivity").using(
      "gin",
      table.participantIds.asc().nullsLast().op("array_ops"),
      table.messageCount.asc().nullsLast().op("array_ops"),
      table.latestActivity.asc().nullsLast().op("array_ops"),
    ),
    index("idx_Conversations_participantIds_title").using(
      "gin",
      table.participantIds.asc().nullsLast().op("array_ops"),
      table.title.asc().nullsLast().op("array_ops"),
    ),
    index("idx_Conversations_schemaVersion").using(
      "btree",
      table.schemaVersion.asc().nullsLast().op("float8_ops"),
    ),
  ],
);

export const debouncerEvents = pgTable(
  "DebouncerEvents",
  {
    ...universalFields,
    id: varchar("_id", { length: 27 }).primaryKey().notNull(),
    name: text().notNull(),
    af: boolean(),
    dispatched: boolean().notNull(),
    failed: boolean(),
    delayTime: timestamp().notNull(),
    upperBoundTime: timestamp().notNull(),
    key: text().notNull(),
    pendingEvents: text().array(),
  },
  (table) => [
    index("idx_DebouncerEvents_dispatched_af_delayTime").using(
      "btree",
      table.dispatched.asc().nullsLast().op("timestamptz_ops"),
      table.af.asc().nullsLast().op("timestamptz_ops"),
      table.delayTime.asc().nullsLast().op("timestamptz_ops"),
    ),
    uniqueIndex("idx_DebouncerEvents_dispatched_af_key_name_filtered")
      .using(
        "btree",
        table.dispatched.asc().nullsLast().op("bool_ops"),
        table.af.asc().nullsLast().op("bool_ops"),
        table.key.asc().nullsLast().op("text_ops"),
        table.name.asc().nullsLast().op("bool_ops"),
      )
      .where(sql`(dispatched IS FALSE)`),
    index("idx_DebouncerEvents_dispatched_af_upperBoundTime").using(
      "btree",
      table.dispatched.asc().nullsLast().op("timestamptz_ops"),
      table.af.asc().nullsLast().op("timestamptz_ops"),
      table.upperBoundTime.asc().nullsLast().op("bool_ops"),
    ),
    index("idx_DebouncerEvents_schemaVersion").using(
      "btree",
      table.schemaVersion.asc().nullsLast().op("float8_ops"),
    ),
  ],
);

export const electionVotes = pgTable(
  "ElectionVotes",
  {
    ...universalFields,
    id: varchar("_id", { length: 27 }).primaryKey().notNull(),
    electionName: text().notNull(),
    userId: varchar({ length: 27 }),
    compareState: jsonb(),
    vote: jsonb(),
    submittedAt: timestamp(),
    userExplanation: text(),
    userOtherComments: text(),
    submissionComments: jsonb(),
  },
  (table) => [
    index("idx_ElectionVotes_electionName").using(
      "btree",
      table.electionName.asc().nullsLast().op("text_ops"),
    ),
    uniqueIndex("idx_ElectionVotes_electionName_userId").using(
      "btree",
      sql`electionName`,
      sql`COALESCE("userId", ''::character varying)`,
    ),
    index("idx_ElectionVotes_schemaVersion").using(
      "btree",
      table.schemaVersion.asc().nullsLast().op("float8_ops"),
    ),
  ],
);

export const curationEmails = pgTable(
  "CurationEmails",
  {
    ...universalFields,
    id: varchar("_id", { length: 27 }).primaryKey().notNull(),
    userId: text().notNull(),
    postId: text().notNull(),
  },
  (table) => [
    index("idx_CurationEmails_schemaVersion").using(
      "btree",
      table.schemaVersion.asc().nullsLast().op("float8_ops"),
    ),
    uniqueIndex("idx_CurationEmails_userId").using(
      "btree",
      table.userId.asc().nullsLast().op("text_ops"),
    ),
  ],
);

export const fieldChanges = pgTable(
  "FieldChanges",
  {
    ...universalFields,
    id: varchar("_id", { length: 27 }).primaryKey().notNull(),
    userId: varchar({ length: 27 }),
    changeGroup: text(),
    documentId: text(),
    fieldName: text(),
    oldValue: jsonb(),
    newValue: jsonb(),
  },
  (table) => [
    index("idx_FieldChanges_documentId_createdAt").using(
      "btree",
      table.documentId.asc().nullsLast().op("timestamptz_ops"),
      table.createdAt.asc().nullsLast().op("timestamptz_ops"),
    ),
    index("idx_FieldChanges_schemaVersion").using(
      "btree",
      table.schemaVersion.asc().nullsLast().op("float8_ops"),
    ),
    index("idx_FieldChanges_userId_createdAt").using(
      "btree",
      table.userId.asc().nullsLast().op("text_ops"),
      table.createdAt.asc().nullsLast().op("text_ops"),
    ),
  ],
);

export const localgroups = pgTable(
  "Localgroups",
  {
    ...universalFields,
    id: varchar("_id", { length: 27 }).primaryKey().notNull(),
    name: text().notNull(),
    organizerIds: varchar({ length: 27 })
      .array()
      .default(["'{}'::VARCHAR[]"])
      .notNull(),
    lastActivity: timestamp().notNull(),
    types: text().array().default(["{LW}"]).notNull(),
    categories: text().array(),
    isOnline: boolean().default(false).notNull(),
    mongoLocation: jsonb(),
    googleLocation: jsonb(),
    location: text(),
    contactInfo: text(),
    facebookLink: text(),
    facebookPageLink: text(),
    meetupLink: text(),
    slackLink: text(),
    website: text(),
    bannerImageId: text(),
    inactive: boolean().default(false).notNull(),
    deleted: boolean().default(false).notNull(),
    contents: jsonb(),
    contentsLatest: text("contents_latest"),
    nameInAnotherLanguage: text(),
    salesforceId: text(),
  },
  (table) => [
    index("idx_Localgroups_inactive_deleted_name").using(
      "btree",
      table.inactive.asc().nullsLast().op("text_ops"),
      table.deleted.asc().nullsLast().op("text_ops"),
      table.name.asc().nullsLast().op("text_ops"),
    ),
    index("idx_Localgroups_isOnline_inactive_deleted_name").using(
      "btree",
      table.isOnline.asc().nullsLast().op("text_ops"),
      table.inactive.asc().nullsLast().op("text_ops"),
      table.deleted.asc().nullsLast().op("text_ops"),
      table.name.asc().nullsLast().op("text_ops"),
    ),
    index("idx_Localgroups_mongoLocation_isOnline_inactive_deleted").using(
      "btree",
      table.mongoLocation.asc().nullsLast().op("bool_ops"),
      table.isOnline.asc().nullsLast().op("bool_ops"),
      table.inactive.asc().nullsLast().op("bool_ops"),
      table.deleted.asc().nullsLast().op("bool_ops"),
    ),
    index("idx_Localgroups_organizerIds_deleted_name").using(
      "gin",
      table.organizerIds.asc().nullsLast().op("array_ops"),
      table.deleted.asc().nullsLast().op("array_ops"),
      table.name.asc().nullsLast().op("array_ops"),
    ),
    index("idx_Localgroups_organizerIds_inactive_deleted").using(
      "gin",
      table.organizerIds.asc().nullsLast().op("array_ops"),
      table.inactive.asc().nullsLast().op("array_ops"),
      table.deleted.asc().nullsLast().op("array_ops"),
    ),
    index("idx_Localgroups_organizerIds_inactive_deleted_name").using(
      "gin",
      table.organizerIds.asc().nullsLast().op("array_ops"),
      table.inactive.asc().nullsLast().op("array_ops"),
      table.deleted.asc().nullsLast().op("array_ops"),
      table.name.asc().nullsLast().op("array_ops"),
    ),
    index("idx_Localgroups_schemaVersion").using(
      "btree",
      table.schemaVersion.asc().nullsLast().op("float8_ops"),
    ),
  ],
);

export const messages = pgTable(
  "Messages",
  {
    ...universalFields,
    id: varchar("_id", { length: 27 }).primaryKey().notNull(),
    userId: varchar({ length: 27 }).notNull(),
    conversationId: varchar({ length: 27 }).notNull(),
    noEmail: boolean().default(false).notNull(),
    contents: jsonb(),
    contentsLatest: text("contents_latest"),
  },
  (table) => [
    index("idx_Messages_conversationId_createdAt").using(
      "btree",
      table.conversationId.asc().nullsLast().op("text_ops"),
      table.createdAt.asc().nullsLast().op("text_ops"),
    ),
    index("idx_Messages_schemaVersion").using(
      "btree",
      table.schemaVersion.asc().nullsLast().op("float8_ops"),
    ),
  ],
);

export const migrations = pgTable(
  "Migrations",
  {
    ...universalFields,
    id: varchar("_id", { length: 27 }).primaryKey().notNull(),
    name: text().notNull(),
    started: timestamp().notNull(),
    finished: boolean().default(false).notNull(),
    succeeded: boolean().default(false).notNull(),
  },
  (table) => [
    index("idx_Migrations_schemaVersion").using(
      "btree",
      table.schemaVersion.asc().nullsLast().op("float8_ops"),
    ),
  ],
);

export const moderatorActions = pgTable(
  "ModeratorActions",
  {
    ...universalFields,
    id: varchar("_id", { length: 27 }).primaryKey().notNull(),
    userId: varchar({ length: 27 }).notNull(),
    type: text().notNull(),
    endedAt: timestamp(),
  },
  (table) => [
    index("idx_ModeratorActions_schemaVersion").using(
      "btree",
      table.schemaVersion.asc().nullsLast().op("float8_ops"),
    ),
    index("idx_ModeratorActions_type_createdAt_endedAt").using(
      "btree",
      table.type.asc().nullsLast().op("text_ops"),
      table.createdAt.asc().nullsLast().op("text_ops"),
      table.endedAt.asc().nullsLast().op("text_ops"),
    ),
    index("idx_ModeratorActions_userId_createdAt").using(
      "btree",
      table.userId.asc().nullsLast().op("text_ops"),
      table.createdAt.asc().nullsLast().op("text_ops"),
    ),
  ],
);

export const emailTokens = pgTable(
  "EmailTokens",
  {
    ...universalFields,
    id: varchar("_id", { length: 27 }).primaryKey().notNull(),
    token: text().notNull(),
    tokenType: text().notNull(),
    userId: varchar({ length: 27 }).notNull(),
    usedAt: timestamp(),
    params: jsonb(),
  },
  (table) => [
    index("idx_EmailTokens_schemaVersion").using(
      "btree",
      table.schemaVersion.asc().nullsLast().op("float8_ops"),
    ),
    index("idx_EmailTokens_token").using(
      "btree",
      table.token.asc().nullsLast().op("text_ops"),
    ),
  ],
);

export const lwEvents = pgTable(
  "LWEvents",
  {
    ...universalFields,
    id: varchar("_id", { length: 27 }).primaryKey().notNull(),
    userId: varchar({ length: 27 }),
    name: text(),
    documentId: text(),
    important: boolean(),
    properties: jsonb(),
    intercom: boolean(),
  },
  (table) => [
    index("idx_LWEvents_name_createdAt").using(
      "btree",
      table.name.asc().nullsLast().op("text_ops"),
      table.createdAt.asc().nullsLast().op("text_ops"),
    ),
    index("idx_LWEvents_name_properties__ip_createdAt_userId").using(
      "gin",
      sql`name`,
      sql`((properties -> 'ip'::text))`,
      sql`createdAt`,
      sql`userId`,
    ),
    index("idx_LWEvents_name_userId_createdAt").using(
      "btree",
      table.name.asc().nullsLast().op("text_ops"),
      table.userId.asc().nullsLast().op("text_ops"),
      table.createdAt.asc().nullsLast().op("text_ops"),
    ),
    index("idx_LWEvents_name_userId_documentId_createdAt").using(
      "btree",
      table.name.asc().nullsLast().op("text_ops"),
      table.userId.asc().nullsLast().op("text_ops"),
      table.documentId.asc().nullsLast().op("text_ops"),
      table.createdAt.asc().nullsLast().op("text_ops"),
    ),
    index("idx_LWEvents_schemaVersion").using(
      "btree",
      table.schemaVersion.asc().nullsLast().op("float8_ops"),
    ),
    index("manual_idx__LWEvents_properties_ip")
      .using("gin", sql`((properties ->> 'ip'::text))`)
      .where(sql`(name = 'login'::text)`)
      .with({ fastupdate: "true" }),
  ],
);

export const notifications = pgTable(
  "Notifications",
  {
    ...universalFields,
    id: varchar("_id", { length: 27 }).primaryKey().notNull(),
    userId: varchar({ length: 27 }).notNull(),
    documentId: text(),
    documentType: text(),
    extraData: jsonb(),
    link: text(),
    title: text(),
    message: text().notNull(),
    type: text().notNull(),
    deleted: boolean().default(false).notNull(),
    viewed: boolean().default(false).notNull(),
    emailed: boolean().default(false).notNull(),
    waitingForBatch: boolean().default(false).notNull(),
  },
  (table) => [
    index("idx_Notifications_createdAt").using(
      "btree",
      table.createdAt.asc().nullsLast().op("timestamptz_ops"),
    ),
    index("idx_Notifications_documentId").using(
      "btree",
      table.documentId.asc().nullsLast().op("text_ops"),
    ),
    index("idx_Notifications_schemaVersion").using(
      "btree",
      table.schemaVersion.asc().nullsLast().op("float8_ops"),
    ),
    index("idx_Notifications_userId_emailed_waitingForBatch_createdAt_type").using(
      "btree",
      table.userId.asc().nullsLast().op("text_ops"),
      table.emailed.asc().nullsLast().op("text_ops"),
      table.waitingForBatch.asc().nullsLast().op("text_ops"),
      table.createdAt.asc().nullsLast().op("text_ops"),
      table.type.asc().nullsLast().op("text_ops"),
    ),
    index("idx_Notifications_userId_type_createdAt").using(
      "btree",
      table.userId.asc().nullsLast().op("text_ops"),
      table.type.asc().nullsLast().op("text_ops"),
      table.createdAt.asc().nullsLast().op("text_ops"),
    ),
  ],
);

export const podcastEpisodes = pgTable(
  "PodcastEpisodes",
  {
    ...universalFields,
    id: varchar("_id", { length: 27 }).primaryKey().notNull(),
    podcastId: varchar({ length: 27 }).notNull(),
    title: text().notNull(),
    episodeLink: text().notNull(),
    externalEpisodeId: text().notNull(),
  },
  (table) => [
    uniqueIndex("idx_PodcastEpisodes_externalEpisodeId").using(
      "btree",
      table.externalEpisodeId.asc().nullsLast().op("text_ops"),
    ),
    index("idx_PodcastEpisodes_schemaVersion").using(
      "btree",
      table.schemaVersion.asc().nullsLast().op("float8_ops"),
    ),
  ],
);

export const images = pgTable(
  "Images",
  {
    ...universalFields,
    id: varchar("_id", { length: 27 }).primaryKey().notNull(),
    cdnHostedUrl: text().notNull(),
    originalUrl: text(),
    identifier: text().notNull(),
    identifierType: text().notNull(),
  },
  (table) => [
    index("idx_Images_cdnHostedUrl").using(
      "btree",
      table.cdnHostedUrl.asc().nullsLast().op("text_ops"),
    ),
    index("idx_Images_identifier").using(
      "btree",
      table.originalUrl.asc().nullsLast().op("text_ops"),
    ),
    index("idx_Images_schemaVersion").using(
      "btree",
      table.schemaVersion.asc().nullsLast().op("float8_ops"),
    ),
  ],
);

export const forumEvents = pgTable(
  "ForumEvents",
  {
    ...universalFields,
    id: varchar("_id", { length: 27 }).primaryKey().notNull(),
    title: text().notNull(),
    startDate: timestamp().notNull(),
    endDate: timestamp(),
    darkColor: text().default("#000000").notNull(),
    lightColor: text().default("#ffffff").notNull(),
    tagId: varchar({ length: 27 }),
    bannerImageId: text(),
    frontpageDescription: jsonb(),
    frontpageDescriptionLatest: text("frontpageDescription_latest"),
    postPageDescription: jsonb(),
    postPageDescriptionLatest: text("postPageDescription_latest"),
    contrastColor: text(),
    includesPoll: boolean().default(false).notNull(),
    publicData: jsonb(),
    frontpageDescriptionMobile: jsonb(),
    frontpageDescriptionMobileLatest: text("frontpageDescriptionMobile_latest"),
    postId: varchar({ length: 27 }),
    customComponent: text(),
    textColor: text(),
    eventFormat: text().default("BASIC").notNull(),
    maxStickersPerUser: doublePrecision().default(1).notNull(),
    bannerTextColor: text().default("#ffffff").notNull(),
    commentPrompt: text(),
    pollQuestionLatest: text("pollQuestion_latest"),
    pollAgreeWording: text(),
    pollDisagreeWording: text(),
    isGlobal: boolean().default(true).notNull(),
    commentId: varchar({ length: 27 }),
    hideBanner: boolean().default(false).notNull(),
    stickerRequiresComment: boolean().default(true).notNull(),
  },
  (table) => [
    index("idx_ForumEvents_endDate").using(
      "btree",
      table.endDate.asc().nullsLast().op("timestamptz_ops"),
    ),
    index("idx_ForumEvents_schemaVersion").using(
      "btree",
      table.schemaVersion.asc().nullsLast().op("float8_ops"),
    ),
  ],
);

export const postViews = pgTable(
  "PostViews",
  {
    ...universalFields,
    id: varchar("_id", { length: 27 }).primaryKey().notNull(),
    updatedAt: timestamp().notNull(),
    windowStart: timestamp().notNull(),
    windowEnd: timestamp().notNull(),
    postId: varchar({ length: 27 }).notNull(),
    viewCount: doublePrecision().notNull(),
    uniqueViewCount: doublePrecision().notNull(),
  },
  (table) => [
    index("idx_PostViews_postId").using(
      "btree",
      table.postId.asc().nullsLast().op("text_ops"),
    ),
    uniqueIndex("idx_PostViews_postId_windowStart_windowEnd").using(
      "btree",
      table.postId.asc().nullsLast().op("text_ops"),
      table.windowStart.asc().nullsLast().op("timestamptz_ops"),
      table.windowEnd.asc().nullsLast().op("text_ops"),
    ),
    index("idx_PostViews_schemaVersion").using(
      "btree",
      table.schemaVersion.asc().nullsLast().op("float8_ops"),
    ),
    index("idx_PostViews_windowEnd").using(
      "btree",
      table.windowEnd.asc().nullsLast().op("timestamptz_ops"),
    ),
    index("idx_PostViews_windowStart").using(
      "btree",
      table.windowStart.asc().nullsLast().op("timestamptz_ops"),
    ),
  ],
);

export const postViewTimes = pgTable(
  "PostViewTimes",
  {
    ...universalFields,
    id: varchar("_id", { length: 27 }).primaryKey().notNull(),
    updatedAt: timestamp().notNull(),
    windowStart: timestamp().notNull(),
    windowEnd: timestamp().notNull(),
    clientId: varchar({ length: 27 }).notNull(),
    postId: varchar({ length: 27 }).notNull(),
    totalSeconds: doublePrecision().notNull(),
  },
  (table) => [
    uniqueIndex("idx_PostViewTimes_clientId_postId_windowStart_windowEnd").using(
      "btree",
      table.clientId.asc().nullsLast().op("text_ops"),
      table.postId.asc().nullsLast().op("timestamptz_ops"),
      table.windowStart.asc().nullsLast().op("text_ops"),
      table.windowEnd.asc().nullsLast().op("text_ops"),
    ),
    index("idx_PostViewTimes_postId").using(
      "btree",
      table.postId.asc().nullsLast().op("text_ops"),
    ),
    index("idx_PostViewTimes_schemaVersion").using(
      "btree",
      table.schemaVersion.asc().nullsLast().op("float8_ops"),
    ),
    index("idx_PostViewTimes_windowEnd").using(
      "btree",
      table.windowEnd.asc().nullsLast().op("timestamptz_ops"),
    ),
    index("idx_PostViewTimes_windowStart").using(
      "btree",
      table.windowStart.asc().nullsLast().op("timestamptz_ops"),
    ),
  ],
);

export const podcasts = pgTable(
  "Podcasts",
  {
    ...universalFields,
    id: varchar("_id", { length: 27 }).primaryKey().notNull(),
    title: text().notNull(),
    applePodcastLink: text(),
    spotifyPodcastLink: text(),
  },
  (table) => [
    index("idx_Podcasts_schemaVersion").using(
      "btree",
      table.schemaVersion.asc().nullsLast().op("float8_ops"),
    ),
  ],
);

export const postRecommendations = pgTable(
  "PostRecommendations",
  {
    ...universalFields,
    id: varchar("_id", { length: 27 }).primaryKey().notNull(),
    userId: varchar({ length: 27 }),
    clientId: text(),
    postId: varchar({ length: 27 }).notNull(),
    strategyName: text().notNull(),
    strategySettings: jsonb(),
    recommendationCount: integer().default(0).notNull(),
    lastRecommendedAt: timestamp().notNull(),
    clickedAt: timestamp(),
  },
  (table) => [
    index("idx_PostRecommendations_schemaVersion").using(
      "btree",
      table.schemaVersion.asc().nullsLast().op("float8_ops"),
    ),
    uniqueIndex("idx_PostRecommendations_userId_clientId_postId").using(
      "btree",
      sql`COALESCE("userId", ''::character varying)`,
      sql`COALESCE("clientId", ''::text)`,
      sql`postId`,
    ),
  ],
);

export const postRelations = pgTable(
  "PostRelations",
  {
    ...universalFields,
    id: varchar("_id", { length: 27 }).primaryKey().notNull(),
    type: text().notNull(),
    sourcePostId: varchar({ length: 27 }).notNull(),
    targetPostId: varchar({ length: 27 }).notNull(),
    order: doublePrecision(),
  },
  (table) => [
    index("idx_PostRelations_schemaVersion").using(
      "btree",
      table.schemaVersion.asc().nullsLast().op("float8_ops"),
    ),
    index("idx_PostRelations_sourcePostId_order_createdAt").using(
      "btree",
      table.sourcePostId.asc().nullsLast().op("float8_ops"),
      table.order.asc().nullsLast().op("float8_ops"),
      table.createdAt.asc().nullsLast().op("float8_ops"),
    ),
  ],
);

export const posts = pgTable(
  "Posts",
  {
    ...universalFields,
    id: varchar("_id", { length: 27 }).primaryKey().notNull(),
    postedAt: timestamp().notNull(),
    modifiedAt: timestamp(),
    url: varchar({ length: 500 }),
    title: varchar({ length: 500 }).notNull(),
    slug: text().notNull(),
    viewCount: doublePrecision().default(0).notNull(),
    lastCommentedAt: timestamp(),
    clickCount: doublePrecision().default(0).notNull(),
    deletedDraft: boolean().default(false).notNull(),
    status: doublePrecision().notNull(),
    isFuture: boolean().notNull(),
    sticky: boolean().default(false).notNull(),
    stickyPriority: integer().default(2).notNull(),
    userIp: text(),
    userAgent: text(),
    referrer: text(),
    author: text(),
    userId: varchar({ length: 27 }).notNull(),
    question: boolean().default(false).notNull(),
    authorIsUnreviewed: boolean().default(false).notNull(),
    readTimeMinutesOverride: doublePrecision(),
    submitToFrontpage: boolean().default(true).notNull(),
    hiddenRelatedQuestion: boolean().default(false).notNull(),
    originalPostRelationSourceId: text(),
    shortform: boolean().default(false).notNull(),
    canonicalSource: text(),
    nominationCount2018: doublePrecision().default(0).notNull(),
    nominationCount2019: doublePrecision().default(0).notNull(),
    reviewCount2018: doublePrecision().default(0).notNull(),
    reviewCount2019: doublePrecision().default(0).notNull(),
    reviewCount: doublePrecision().default(0).notNull(),
    reviewVoteCount: doublePrecision().default(0).notNull(),
    positiveReviewVoteCount: doublePrecision().default(0).notNull(),
    reviewVoteScoreAf: doublePrecision().default(0).notNull(),
    reviewVotesAf: doublePrecision().array().default([]).notNull(),
    reviewVoteScoreHighKarma: doublePrecision().default(0).notNull(),
    reviewVotesHighKarma: doublePrecision().array().default([]).notNull(),
    reviewVoteScoreAllKarma: doublePrecision().default(0).notNull(),
    reviewVotesAllKarma: doublePrecision().array().default([]).notNull(),
    finalReviewVoteScoreHighKarma: doublePrecision().default(0).notNull(),
    finalReviewVotesHighKarma: doublePrecision().array().default([]).notNull(),
    finalReviewVoteScoreAllKarma: doublePrecision().default(0).notNull(),
    finalReviewVotesAllKarma: doublePrecision().array().default([]).notNull(),
    finalReviewVoteScoreAf: doublePrecision().default(0).notNull(),
    finalReviewVotesAf: doublePrecision().array().default([]).notNull(),
    lastCommentPromotedAt: timestamp(),
    tagRelevance: jsonb(),
    noIndex: boolean().default(false).notNull(),
    rsvps: jsonb().array(),
    activateRsvPs: boolean(),
    nextDayReminderSent: boolean().default(false).notNull(),
    onlyVisibleToLoggedIn: boolean().default(false).notNull(),
    onlyVisibleToEstablishedAccounts: boolean().default(false).notNull(),
    hideFromRecentDiscussions: boolean().default(false).notNull(),
    votingSystem: text().default("twoAxis"),
    podcastEpisodeId: varchar({ length: 27 }),
    legacy: boolean().default(false).notNull(),
    legacyId: text(),
    legacySpam: boolean().default(false).notNull(),
    feedId: varchar({ length: 27 }),
    feedLink: text(),
    curatedDate: timestamp(),
    metaDate: timestamp(),
    suggestForCuratedUserIds: varchar({ length: 27 }).array(),
    frontpageDate: timestamp(),
    collectionTitle: text(),
    coauthorStatuses: jsonb().array(),
    hasCoauthorPermission: boolean().default(true).notNull(),
    socialPreviewImageId: text(),
    socialPreviewImageAutoUrl: text(),
    fmCrosspost: jsonb().default({ isCrosspost: false }).notNull(),
    canonicalSequenceId: varchar({ length: 27 }),
    canonicalCollectionSlug: text(),
    canonicalBookId: varchar({ length: 27 }),
    canonicalNextPostSlug: text(),
    canonicalPrevPostSlug: text(),
    unlisted: boolean().default(false).notNull(),
    disableRecommendation: boolean().default(false).notNull(),
    defaultRecommendation: boolean().default(false).notNull(),
    draft: boolean().default(false).notNull(),
    meta: boolean().default(false).notNull(),
    hideFrontpageComments: boolean().default(false).notNull(),
    maxBaseScore: doublePrecision().notNull(),
    scoreExceeded2Date: timestamp(),
    scoreExceeded30Date: timestamp(),
    scoreExceeded45Date: timestamp(),
    scoreExceeded75Date: timestamp(),
    scoreExceeded125Date: timestamp(),
    scoreExceeded200Date: timestamp(),
    bannedUserIds: varchar({ length: 27 }).array(),
    commentsLocked: boolean(),
    commentsLockedToAccountsCreatedAfter: timestamp(),
    organizerIds: varchar({ length: 27 })
      .array()
      .default(["}'::character varying(2"])
      .notNull(),
    groupId: varchar({ length: 27 }),
    eventType: text(),
    isEvent: boolean().default(false).notNull(),
    reviewedByUserId: varchar({ length: 27 }),
    reviewForCuratedUserId: varchar({ length: 27 }),
    startTime: timestamp(),
    localStartTime: timestamp(),
    endTime: timestamp(),
    localEndTime: timestamp(),
    eventRegistrationLink: text(),
    joinEventLink: text(),
    onlineEvent: boolean().default(false).notNull(),
    globalEvent: boolean().default(false).notNull(),
    mongoLocation: jsonb(),
    googleLocation: jsonb(),
    location: text(),
    contactInfo: text(),
    facebookLink: text(),
    meetupLink: text(),
    website: text(),
    eventImageId: text(),
    types: text().array(),
    metaSticky: boolean().default(false).notNull(),
    sharingSettings: jsonb(),
    shareWithUsers: varchar({ length: 27 })
      .array()
      .default(["}'::character varying(2"])
      .notNull(),
    linkSharingKey: text(),
    linkSharingKeyUsedBy: varchar({ length: 27 }).array(),
    commentSortOrder: text(),
    hideAuthor: boolean().default(false).notNull(),
    sideCommentVisibility: text(),
    moderationStyle: text(),
    hideCommentKarma: boolean().default(false).notNull(),
    commentCount: doublePrecision().default(0).notNull(),
    subforumTagId: varchar({ length: 27 }),
    af: boolean().default(false).notNull(),
    afDate: timestamp(),
    afCommentCount: doublePrecision().default(0).notNull(),
    afLastCommentedAt: timestamp(),
    afSticky: boolean().default(false).notNull(),
    suggestForAlignmentUserIds: text().array().default([""]).notNull(),
    reviewForAlignmentUserId: text(),
    agentFoundationsId: text(),
    contentsLatest: text("contents_latest"),
    pingbacks: jsonb(),
    moderationGuidelinesLatest: text("moderationGuidelines_latest"),
    customHighlight: jsonb(),
    customHighlightLatest: text("customHighlight_latest"),
    voteCount: doublePrecision().default(0).notNull(),
    baseScore: doublePrecision().default(0).notNull(),
    extendedScore: jsonb(),
    score: doublePrecision().default(0).notNull(),
    inactive: boolean().default(false).notNull(),
    afBaseScore: doublePrecision(),
    afExtendedScore: jsonb(),
    afVoteCount: doublePrecision(),
    debate: boolean().default(false).notNull(),
    rejected: boolean().default(false).notNull(),
    rejectedByUserId: varchar({ length: 27 }),
    rejectedReason: text(),
    ignoreRateLimits: boolean(),
    socialPreview: jsonb(),
    topLevelCommentCount: doublePrecision().default(0).notNull(),
    postCategory: text().default("post").notNull(),
    forceAllowType3Audio: boolean().default(false).notNull(),
    hideFromPopularComments: boolean().default(false).notNull(),
    wasEverUndrafted: boolean().default(false).notNull(),
    collabEditorDialogue: boolean().default(false).notNull(),
    mostRecentPublishedDialogueResponseDate: timestamp(),
    manifoldReviewMarketId: text(),
    swrCachingEnabled: boolean().default(false).notNull(),
    disableSidenotes: boolean().default(false).notNull(),
    autoFrontpage: text(),
    generateDraftJargon: boolean().default(false).notNull(),
    coauthorUserIds: text().array().default([""]).notNull(),
    marginalFundingOrg: text(),
  },
  (table) => [
    index("idx_Posts_agentFoundationsId").using(
      "btree",
      table.agentFoundationsId.asc().nullsLast().op("text_ops"),
    ),
    index("idx_Posts_debate").using(
      "btree",
      table.debate.asc().nullsLast().op("bool_ops"),
    ),
    index("idx_Posts_defaultRecommendation").using(
      "btree",
      table.defaultRecommendation.asc().nullsLast().op("bool_ops"),
    ),
    index("idx_Posts_fmCrosspost__foreignPostId_postedAt").using(
      "gin",
      sql`(("fmCrosspost" -> 'foreignPostId'::text))`,
      sql`postedAt`,
    ),
    index("idx_Posts_fmCrosspost_postedAt").using(
      "gin",
      table.fmCrosspost.asc().nullsLast().op("timestamptz_ops"),
      table.postedAt.asc().nullsLast().op("timestamptz_ops"),
    ),
    index("idx_Posts_inactive_postedAt").using(
      "btree",
      table.inactive.asc().nullsLast().op("bool_ops"),
      table.postedAt.asc().nullsLast().op("bool_ops"),
    ),
    index("idx_Posts_isFuture_postedAt").using(
      "btree",
      table.isFuture.asc().nullsLast().op("bool_ops"),
      table.postedAt.asc().nullsLast().op("bool_ops"),
    ),
    index("idx_Posts_legacyId").using(
      "btree",
      table.legacyId.asc().nullsLast().op("text_ops"),
    ),
    index("idx_Posts_max_postedAt_mostRecentPublishedDialogueResponseDate")
      .using(
        "btree",
        sql`GREATEST("postedAt", "mostRecentPublishedDialogueResponseDate")`,
      )
      .where(sql`("collabEditorDialogue" IS TRUE)`),
    index("idx_Posts_schemaVersion").using(
      "btree",
      table.schemaVersion.asc().nullsLast().op("float8_ops"),
    ),
    index("idx_Posts_slug").using(
      "btree",
      table.slug.asc().nullsLast().op("text_ops"),
    ),
    index("idx_Posts_status_isFuture_draft_unlisted_authorIsUnreviewed_hid").using(
      "btree",
      table.status.asc().nullsLast().op("timestamptz_ops"),
      table.isFuture.asc().nullsLast().op("timestamptz_ops"),
      table.draft.asc().nullsLast().op("timestamptz_ops"),
      table.unlisted.asc().nullsLast().op("timestamptz_ops"),
      table.authorIsUnreviewed.asc().nullsLast().op("timestamptz_ops"),
      table.hideFrontpageComments.asc().nullsLast().op("timestamptz_ops"),
      table.lastCommentedAt.asc().nullsLast().op("timestamptz_ops"),
      table.id.asc().nullsLast().op("float8_ops"),
      table.baseScore.asc().nullsLast().op("float8_ops"),
      table.af.asc().nullsLast().op("timestamptz_ops"),
      table.isEvent.asc().nullsLast().op("timestamptz_ops"),
      table.globalEvent.asc().nullsLast().op("timestamptz_ops"),
      table.commentCount.asc().nullsLast().op("timestamptz_ops"),
    ),
    index("idx_Posts_status_isFuture_draft_unlisted_shortform_hiddenRelate").using(
      "btree",
      table.status.asc().nullsLast().op("float8_ops"),
      table.isFuture.asc().nullsLast().op("timestamptz_ops"),
      table.draft.asc().nullsLast().op("timestamptz_ops"),
      table.unlisted.asc().nullsLast().op("timestamptz_ops"),
      table.shortform.asc().nullsLast().op("timestamptz_ops"),
      table.hiddenRelatedQuestion.asc().nullsLast().op("float8_ops"),
      table.authorIsUnreviewed.asc().nullsLast().op("bool_ops"),
      table.groupId.asc().nullsLast().op("float8_ops"),
      table.rejected.asc().nullsLast().op("timestamptz_ops"),
      table.postedAt.asc().nullsLast().op("timestamptz_ops"),
      table.id.asc().nullsLast().op("timestamptz_ops"),
      table.meta.asc().nullsLast().op("timestamptz_ops"),
      table.isEvent.asc().nullsLast().op("text_ops"),
      table.af.asc().nullsLast().op("timestamptz_ops"),
      table.frontpageDate.asc().nullsLast().op("timestamptz_ops"),
      table.curatedDate.asc().nullsLast().op("timestamptz_ops"),
      table.baseScore.asc().nullsLast().op("timestamptz_ops"),
    ),
    index("idx_Posts_tagRelevance").using(
      "gin",
      table.tagRelevance.asc().nullsLast().op("jsonb_ops"),
    ),
    index("idx_Posts_tagRelevance__$**").using(
      "gin",
      sql`(("tagRelevance" -> '$**'::text))`,
    ),
    index("idx_Posts_url_postedAt").using(
      "btree",
      table.url.asc().nullsLast().op("text_ops"),
      table.postedAt.asc().nullsLast().op("timestamptz_ops"),
    ),
    index("idx_Posts_userId_createdAt").using(
      "btree",
      table.userId.asc().nullsLast().op("text_ops"),
      table.createdAt.asc().nullsLast().op("text_ops"),
    ),
    index("idx_Posts_userId_postedAt").using(
      "btree",
      table.userId.asc().nullsLast().op("timestamptz_ops"),
      table.postedAt.asc().nullsLast().op("timestamptz_ops"),
    ),
    index("idx_posts_2dsphere").using(
      "btree",
      table.status.asc().nullsLast().op("text_ops"),
      table.isFuture.asc().nullsLast().op("text_ops"),
      table.draft.asc().nullsLast().op("text_ops"),
      table.unlisted.asc().nullsLast().op("text_ops"),
      table.shortform.asc().nullsLast().op("bool_ops"),
      table.hiddenRelatedQuestion.asc().nullsLast().op("float8_ops"),
      table.authorIsUnreviewed.asc().nullsLast().op("jsonb_ops"),
      table.groupId.asc().nullsLast().op("text_ops"),
      table.mongoLocation.asc().nullsLast().op("float8_ops"),
      table.eventType.asc().nullsLast().op("text_ops"),
      table.startTime.asc().nullsLast().op("timestamptz_ops"),
      table.endTime.asc().nullsLast().op("text_ops"),
      table.id.asc().nullsLast().op("bool_ops"),
      table.meta.asc().nullsLast().op("text_ops"),
      table.isEvent.asc().nullsLast().op("text_ops"),
      table.af.asc().nullsLast().op("text_ops"),
      table.frontpageDate.asc().nullsLast().op("jsonb_ops"),
      table.curatedDate.asc().nullsLast().op("jsonb_ops"),
      table.postedAt.asc().nullsLast().op("float8_ops"),
      table.baseScore.asc().nullsLast().op("float8_ops"),
    ),
    index("idx_posts_agentFoundationsId").using(
      "btree",
      table.agentFoundationsId.asc().nullsLast().op("text_ops"),
    ),
    index("idx_posts_alignmentSuggestedPosts")
      .using(
        "gin",
        table.status.asc().nullsLast().op("bool_ops"),
        table.isFuture.asc().nullsLast().op("bool_ops"),
        table.draft.asc().nullsLast().op("bool_ops"),
        table.unlisted.asc().nullsLast().op("varchar_ops"),
        table.shortform.asc().nullsLast().op("array_ops"),
        table.hiddenRelatedQuestion.asc().nullsLast().op("bool_ops"),
        table.authorIsUnreviewed.asc().nullsLast().op("array_ops"),
        table.groupId.asc().nullsLast().op("array_ops"),
        table.reviewForAlignmentUserId.asc().nullsLast().op("timestamptz_ops"),
        table.af.asc().nullsLast().op("bool_ops"),
        table.suggestForAlignmentUserIds.asc().nullsLast().op("bool_ops"),
        table.createdAt.asc().nullsLast().op("bool_ops"),
        table.id.asc().nullsLast().op("timestamptz_ops"),
        table.meta.asc().nullsLast().op("timestamptz_ops"),
        table.isEvent.asc().nullsLast().op("bool_ops"),
        table.frontpageDate.asc().nullsLast().op("bool_ops"),
        table.curatedDate.asc().nullsLast().op("float8_ops"),
        table.postedAt.asc().nullsLast().op("bool_ops"),
        table.baseScore.asc().nullsLast().op("timestamptz_ops"),
      )
      .where(sql`("suggestForAlignmentUserIds"[0] IS NOT NULL)`),
    index("idx_posts_coauthorStatuses_postedAt").using(
      "gin",
      table.status.asc().nullsLast().op("bool_ops"),
      table.isFuture.asc().nullsLast().op("array_ops"),
      table.draft.asc().nullsLast().op("bool_ops"),
      table.unlisted.asc().nullsLast().op("bool_ops"),
      table.shortform.asc().nullsLast().op("float8_ops"),
      table.hiddenRelatedQuestion.asc().nullsLast().op("float8_ops"),
      table.authorIsUnreviewed.asc().nullsLast().op("varchar_ops"),
      table.groupId.asc().nullsLast().op("float8_ops"),
      table.coauthorStatuses.asc().nullsLast().op("float8_ops"),
      table.userId.asc().nullsLast().op("float8_ops"),
      table.postedAt.asc().nullsLast().op("float8_ops"),
      table.id.asc().nullsLast().op("float8_ops"),
      table.meta.asc().nullsLast().op("varchar_ops"),
      table.isEvent.asc().nullsLast().op("float8_ops"),
      table.af.asc().nullsLast().op("float8_ops"),
      table.frontpageDate.asc().nullsLast().op("float8_ops"),
      table.curatedDate.asc().nullsLast().op("array_ops"),
      table.baseScore.asc().nullsLast().op("timestamptz_ops"),
    ),
    index("idx_posts_coauthorUserIds_postedAt").using(
      "gin",
      table.status.asc().nullsLast().op("array_ops"),
      table.isFuture.asc().nullsLast().op("array_ops"),
      table.draft.asc().nullsLast().op("array_ops"),
      table.unlisted.asc().nullsLast().op("varchar_ops"),
      table.shortform.asc().nullsLast().op("float8_ops"),
      table.hiddenRelatedQuestion.asc().nullsLast().op("array_ops"),
      table.authorIsUnreviewed.asc().nullsLast().op("array_ops"),
      table.groupId.asc().nullsLast().op("array_ops"),
      table.coauthorUserIds.asc().nullsLast().op("array_ops"),
      table.userId.asc().nullsLast().op("float8_ops"),
      table.postedAt.asc().nullsLast().op("array_ops"),
      table.id.asc().nullsLast().op("array_ops"),
      table.meta.asc().nullsLast().op("array_ops"),
      table.isEvent.asc().nullsLast().op("float8_ops"),
      table.af.asc().nullsLast().op("array_ops"),
      table.frontpageDate.asc().nullsLast().op("array_ops"),
      table.curatedDate.asc().nullsLast().op("array_ops"),
      table.baseScore.asc().nullsLast().op("bool_ops"),
    ),
    index("idx_posts_community").using(
      "btree",
      table.status.asc().nullsLast().op("float8_ops"),
      table.isFuture.asc().nullsLast().op("float8_ops"),
      table.draft.asc().nullsLast().op("float8_ops"),
      table.unlisted.asc().nullsLast().op("float8_ops"),
      table.shortform.asc().nullsLast().op("float8_ops"),
      table.hiddenRelatedQuestion.asc().nullsLast().op("float8_ops"),
      table.authorIsUnreviewed.asc().nullsLast().op("float8_ops"),
      table.groupId.asc().nullsLast().op("float8_ops"),
      table.sticky.asc().nullsLast().op("text_ops"),
      table.score.asc().nullsLast().op("text_ops"),
      table.id.asc().nullsLast().op("timestamptz_ops"),
      table.meta.asc().nullsLast().op("text_ops"),
      table.isEvent.asc().nullsLast().op("float8_ops"),
      table.af.asc().nullsLast().op("timestamptz_ops"),
      table.frontpageDate.asc().nullsLast().op("text_ops"),
      table.curatedDate.asc().nullsLast().op("text_ops"),
      table.postedAt.asc().nullsLast().op("float8_ops"),
      table.baseScore.asc().nullsLast().op("float8_ops"),
    ),
    index("idx_posts_curated")
      .using(
        "btree",
        table.status.asc().nullsLast().op("float8_ops"),
        table.isFuture.asc().nullsLast().op("float8_ops"),
        table.draft.asc().nullsLast().op("float8_ops"),
        table.unlisted.asc().nullsLast().op("float8_ops"),
        table.shortform.asc().nullsLast().op("bool_ops"),
        table.hiddenRelatedQuestion.asc().nullsLast().op("timestamptz_ops"),
        table.authorIsUnreviewed.asc().nullsLast().op("timestamptz_ops"),
        table.groupId.asc().nullsLast().op("timestamptz_ops"),
        table.sticky.asc().nullsLast().op("timestamptz_ops"),
        table.curatedDate.asc().nullsLast().op("text_ops"),
        table.postedAt.asc().nullsLast().op("bool_ops"),
        table.id.asc().nullsLast().op("timestamptz_ops"),
        table.meta.asc().nullsLast().op("timestamptz_ops"),
        table.isEvent.asc().nullsLast().op("timestamptz_ops"),
        table.af.asc().nullsLast().op("text_ops"),
        table.frontpageDate.asc().nullsLast().op("text_ops"),
        table.baseScore.asc().nullsLast().op("bool_ops"),
      )
      .where(
        sql`("curatedDate" > '1970-01-01 00:00:00+00'::timestamp with time zone)`,
      ),
    index("idx_posts_defaultRecommendation").using(
      "btree",
      table.defaultRecommendation.asc().nullsLast().op("bool_ops"),
    ),
    index("idx_posts_events").using(
      "btree",
      table.status.asc().nullsLast().op("timestamptz_ops"),
      table.isFuture.asc().nullsLast().op("timestamptz_ops"),
      table.draft.asc().nullsLast().op("timestamptz_ops"),
      table.unlisted.asc().nullsLast().op("timestamptz_ops"),
      table.shortform.asc().nullsLast().op("float8_ops"),
      table.hiddenRelatedQuestion.asc().nullsLast().op("bool_ops"),
      table.authorIsUnreviewed.asc().nullsLast().op("timestamptz_ops"),
      table.groupId.asc().nullsLast().op("timestamptz_ops"),
      table.globalEvent.asc().nullsLast().op("timestamptz_ops"),
      table.onlineEvent.asc().nullsLast().op("text_ops"),
      table.startTime.asc().nullsLast().op("float8_ops"),
      table.endTime.asc().nullsLast().op("timestamptz_ops"),
      table.createdAt.asc().nullsLast().op("bool_ops"),
      table.baseScore.asc().nullsLast().op("bool_ops"),
      table.id.asc().nullsLast().op("text_ops"),
      table.meta.asc().nullsLast().op("timestamptz_ops"),
      table.isEvent.asc().nullsLast().op("float8_ops"),
      table.af.asc().nullsLast().op("bool_ops"),
      table.frontpageDate.asc().nullsLast().op("float8_ops"),
      table.curatedDate.asc().nullsLast().op("text_ops"),
      table.postedAt.asc().nullsLast().op("float8_ops"),
    ),
    index("idx_posts_fmCrosspost__foreignPostId_postedAt").using(
      "gin",
      sql`(("fmCrosspost" -> 'foreignPostId'::text))`,
      sql`postedAt`,
    ),
    index("idx_posts_frontpage")
      .using(
        "btree",
        table.status.asc().nullsLast().op("int4_ops"),
        table.isFuture.asc().nullsLast().op("int4_ops"),
        table.draft.asc().nullsLast().op("int4_ops"),
        table.unlisted.asc().nullsLast().op("int4_ops"),
        table.shortform.asc().nullsLast().op("int4_ops"),
        table.hiddenRelatedQuestion.asc().nullsLast().op("int4_ops"),
        table.authorIsUnreviewed.asc().nullsLast().op("int4_ops"),
        table.groupId.asc().nullsLast().op("text_ops"),
        table.sticky.asc().nullsLast().op("timestamptz_ops"),
        table.stickyPriority.asc().nullsLast().op("float8_ops"),
        table.score.asc().nullsLast().op("timestamptz_ops"),
        table.frontpageDate.asc().nullsLast().op("timestamptz_ops"),
        table.id.asc().nullsLast().op("bool_ops"),
        table.meta.asc().nullsLast().op("bool_ops"),
        table.isEvent.asc().nullsLast().op("bool_ops"),
        table.af.asc().nullsLast().op("text_ops"),
        table.curatedDate.asc().nullsLast().op("float8_ops"),
        table.postedAt.asc().nullsLast().op("bool_ops"),
        table.baseScore.asc().nullsLast().op("timestamptz_ops"),
      )
      .where(
        sql`("frontpageDate" > '1970-01-01 00:00:00+00'::timestamp with time zone)`,
      ),
    index("idx_posts_globalEvents").using(
      "btree",
      table.status.asc().nullsLast().op("timestamptz_ops"),
      table.isFuture.asc().nullsLast().op("timestamptz_ops"),
      table.draft.asc().nullsLast().op("timestamptz_ops"),
      table.unlisted.asc().nullsLast().op("timestamptz_ops"),
      table.shortform.asc().nullsLast().op("timestamptz_ops"),
      table.hiddenRelatedQuestion.asc().nullsLast().op("timestamptz_ops"),
      table.authorIsUnreviewed.asc().nullsLast().op("timestamptz_ops"),
      table.groupId.asc().nullsLast().op("text_ops"),
      table.globalEvent.asc().nullsLast().op("float8_ops"),
      table.eventType.asc().nullsLast().op("float8_ops"),
      table.startTime.asc().nullsLast().op("float8_ops"),
      table.endTime.asc().nullsLast().op("float8_ops"),
      table.id.asc().nullsLast().op("float8_ops"),
      table.meta.asc().nullsLast().op("timestamptz_ops"),
      table.isEvent.asc().nullsLast().op("text_ops"),
      table.af.asc().nullsLast().op("float8_ops"),
      table.frontpageDate.asc().nullsLast().op("float8_ops"),
      table.curatedDate.asc().nullsLast().op("float8_ops"),
      table.postedAt.asc().nullsLast().op("timestamptz_ops"),
      table.baseScore.asc().nullsLast().op("bool_ops"),
    ),
    index("idx_posts_inactive_postedAt").using(
      "btree",
      table.inactive.asc().nullsLast().op("timestamptz_ops"),
      table.postedAt.asc().nullsLast().op("timestamptz_ops"),
    ),
    index("idx_posts_isFuture_postedAt").using(
      "btree",
      table.isFuture.asc().nullsLast().op("bool_ops"),
      table.postedAt.asc().nullsLast().op("timestamptz_ops"),
    ),
    index("idx_posts_legacyId").using(
      "btree",
      table.legacyId.asc().nullsLast().op("text_ops"),
    ),
    index("idx_posts_nominatablePostsByVote").using(
      "btree",
      table.status.asc().nullsLast().op("timestamptz_ops"),
      table.isFuture.asc().nullsLast().op("text_ops"),
      table.draft.asc().nullsLast().op("text_ops"),
      table.unlisted.asc().nullsLast().op("float8_ops"),
      table.shortform.asc().nullsLast().op("text_ops"),
      table.hiddenRelatedQuestion.asc().nullsLast().op("float8_ops"),
      table.authorIsUnreviewed.asc().nullsLast().op("float8_ops"),
      table.groupId.asc().nullsLast().op("float8_ops"),
      table.id.asc().nullsLast().op("timestamptz_ops"),
      table.userId.asc().nullsLast().op("timestamptz_ops"),
      table.isEvent.asc().nullsLast().op("text_ops"),
      table.baseScore.asc().nullsLast().op("timestamptz_ops"),
      table.meta.asc().nullsLast().op("float8_ops"),
      table.af.asc().nullsLast().op("bool_ops"),
      table.frontpageDate.asc().nullsLast().op("float8_ops"),
      table.curatedDate.asc().nullsLast().op("bool_ops"),
      table.postedAt.asc().nullsLast().op("float8_ops"),
    ),
    index("idx_posts_pingbackPosts").using(
      "gin",
      table.status.asc().nullsLast().op("float8_ops"),
      table.isFuture.asc().nullsLast().op("jsonb_ops"),
      table.draft.asc().nullsLast().op("jsonb_ops"),
      table.unlisted.asc().nullsLast().op("jsonb_ops"),
      table.shortform.asc().nullsLast().op("jsonb_ops"),
      table.hiddenRelatedQuestion.asc().nullsLast().op("jsonb_ops"),
      table.authorIsUnreviewed.asc().nullsLast().op("bool_ops"),
      table.groupId.asc().nullsLast().op("varchar_ops"),
      table.pingbacks.asc().nullsLast().op("timestamptz_ops"),
      table.baseScore.asc().nullsLast().op("timestamptz_ops"),
      table.id.asc().nullsLast().op("timestamptz_ops"),
      table.meta.asc().nullsLast().op("bool_ops"),
      table.isEvent.asc().nullsLast().op("varchar_ops"),
      table.af.asc().nullsLast().op("timestamptz_ops"),
      table.frontpageDate.asc().nullsLast().op("timestamptz_ops"),
      table.curatedDate.asc().nullsLast().op("float8_ops"),
      table.postedAt.asc().nullsLast().op("timestamptz_ops"),
    ),
    index("idx_posts_pingbacks").using(
      "gin",
      table.pingbacks.asc().nullsLast().op("jsonb_ops"),
    ),
    index("idx_posts_positiveReviewVoteCount").using(
      "btree",
      table.status.asc().nullsLast().op("bool_ops"),
      table.isFuture.asc().nullsLast().op("timestamptz_ops"),
      table.draft.asc().nullsLast().op("timestamptz_ops"),
      table.unlisted.asc().nullsLast().op("timestamptz_ops"),
      table.shortform.asc().nullsLast().op("timestamptz_ops"),
      table.hiddenRelatedQuestion.asc().nullsLast().op("timestamptz_ops"),
      table.authorIsUnreviewed.asc().nullsLast().op("bool_ops"),
      table.groupId.asc().nullsLast().op("timestamptz_ops"),
      table.positiveReviewVoteCount.asc().nullsLast().op("timestamptz_ops"),
      table.createdAt.asc().nullsLast().op("timestamptz_ops"),
      table.id.asc().nullsLast().op("timestamptz_ops"),
      table.meta.asc().nullsLast().op("timestamptz_ops"),
      table.isEvent.asc().nullsLast().op("timestamptz_ops"),
      table.af.asc().nullsLast().op("bool_ops"),
      table.frontpageDate.asc().nullsLast().op("text_ops"),
      table.curatedDate.asc().nullsLast().op("bool_ops"),
      table.postedAt.asc().nullsLast().op("timestamptz_ops"),
      table.baseScore.asc().nullsLast().op("float8_ops"),
    ),
    index("idx_posts_positiveReviewVoteCountReviewCount").using(
      "btree",
      table.status.asc().nullsLast().op("float8_ops"),
      table.isFuture.asc().nullsLast().op("float8_ops"),
      table.draft.asc().nullsLast().op("float8_ops"),
      table.unlisted.asc().nullsLast().op("float8_ops"),
      table.shortform.asc().nullsLast().op("float8_ops"),
      table.hiddenRelatedQuestion.asc().nullsLast().op("float8_ops"),
      table.authorIsUnreviewed.asc().nullsLast().op("float8_ops"),
      table.groupId.asc().nullsLast().op("float8_ops"),
      table.positiveReviewVoteCount.asc().nullsLast().op("text_ops"),
      table.reviewCount.asc().nullsLast().op("timestamptz_ops"),
      table.createdAt.asc().nullsLast().op("float8_ops"),
      table.id.asc().nullsLast().op("float8_ops"),
      table.meta.asc().nullsLast().op("float8_ops"),
      table.isEvent.asc().nullsLast().op("float8_ops"),
      table.af.asc().nullsLast().op("float8_ops"),
      table.frontpageDate.asc().nullsLast().op("float8_ops"),
      table.curatedDate.asc().nullsLast().op("float8_ops"),
      table.postedAt.asc().nullsLast().op("float8_ops"),
      table.baseScore.asc().nullsLast().op("float8_ops"),
    ),
    index("idx_posts_postedAt_baseScore").using(
      "btree",
      table.status.asc().nullsLast().op("float8_ops"),
      table.isFuture.asc().nullsLast().op("bool_ops"),
      table.draft.asc().nullsLast().op("bool_ops"),
      table.unlisted.asc().nullsLast().op("float8_ops"),
      table.shortform.asc().nullsLast().op("bool_ops"),
      table.hiddenRelatedQuestion.asc().nullsLast().op("timestamptz_ops"),
      table.authorIsUnreviewed.asc().nullsLast().op("timestamptz_ops"),
      table.groupId.asc().nullsLast().op("float8_ops"),
      table.postedAt.asc().nullsLast().op("float8_ops"),
      table.baseScore.asc().nullsLast().op("float8_ops"),
      table.id.asc().nullsLast().op("float8_ops"),
      table.meta.asc().nullsLast().op("float8_ops"),
      table.isEvent.asc().nullsLast().op("text_ops"),
      table.af.asc().nullsLast().op("float8_ops"),
      table.frontpageDate.asc().nullsLast().op("float8_ops"),
      table.curatedDate.asc().nullsLast().op("float8_ops"),
    ),
    index("idx_posts_postsWithBannedUsers").using(
      "gin",
      table.status.asc().nullsLast().op("array_ops"),
      table.isFuture.asc().nullsLast().op("array_ops"),
      table.draft.asc().nullsLast().op("array_ops"),
      table.unlisted.asc().nullsLast().op("array_ops"),
      table.shortform.asc().nullsLast().op("array_ops"),
      table.hiddenRelatedQuestion.asc().nullsLast().op("bool_ops"),
      table.authorIsUnreviewed.asc().nullsLast().op("array_ops"),
      table.groupId.asc().nullsLast().op("array_ops"),
      table.bannedUserIds.asc().nullsLast().op("timestamptz_ops"),
      table.createdAt.asc().nullsLast().op("varchar_ops"),
      table.id.asc().nullsLast().op("timestamptz_ops"),
      table.meta.asc().nullsLast().op("bool_ops"),
      table.isEvent.asc().nullsLast().op("float8_ops"),
      table.af.asc().nullsLast().op("array_ops"),
      table.frontpageDate.asc().nullsLast().op("timestamptz_ops"),
      table.curatedDate.asc().nullsLast().op("array_ops"),
      table.postedAt.asc().nullsLast().op("array_ops"),
      table.baseScore.asc().nullsLast().op("array_ops"),
    ),
    index("idx_posts_recentDiscussionThreadsList").using(
      "btree",
      table.status.asc().nullsLast().op("float8_ops"),
      table.isFuture.asc().nullsLast().op("float8_ops"),
      table.draft.asc().nullsLast().op("float8_ops"),
      table.unlisted.asc().nullsLast().op("float8_ops"),
      table.shortform.asc().nullsLast().op("float8_ops"),
      table.hiddenRelatedQuestion.asc().nullsLast().op("text_ops"),
      table.authorIsUnreviewed.asc().nullsLast().op("float8_ops"),
      table.groupId.asc().nullsLast().op("float8_ops"),
      table.lastCommentedAt.asc().nullsLast().op("float8_ops"),
      table.baseScore.asc().nullsLast().op("float8_ops"),
      table.hideFrontpageComments.asc().nullsLast().op("float8_ops"),
      table.id.asc().nullsLast().op("text_ops"),
      table.meta.asc().nullsLast().op("text_ops"),
      table.isEvent.asc().nullsLast().op("text_ops"),
      table.af.asc().nullsLast().op("text_ops"),
      table.frontpageDate.asc().nullsLast().op("timestamptz_ops"),
      table.curatedDate.asc().nullsLast().op("timestamptz_ops"),
      table.postedAt.asc().nullsLast().op("bool_ops"),
    ),
    index("idx_posts_recommendable").using(
      "btree",
      table.status.asc().nullsLast().op("text_ops"),
      table.isFuture.asc().nullsLast().op("timestamptz_ops"),
      table.draft.asc().nullsLast().op("timestamptz_ops"),
      table.unlisted.asc().nullsLast().op("float8_ops"),
      table.shortform.asc().nullsLast().op("bool_ops"),
      table.hiddenRelatedQuestion.asc().nullsLast().op("timestamptz_ops"),
      table.authorIsUnreviewed.asc().nullsLast().op("bool_ops"),
      table.groupId.asc().nullsLast().op("timestamptz_ops"),
      table.meta.asc().nullsLast().op("timestamptz_ops"),
      table.disableRecommendation.asc().nullsLast().op("bool_ops"),
      table.baseScore.asc().nullsLast().op("float8_ops"),
      table.curatedDate.asc().nullsLast().op("float8_ops"),
      table.frontpageDate.asc().nullsLast().op("float8_ops"),
      table.id.asc().nullsLast().op("float8_ops"),
      table.isEvent.asc().nullsLast().op("text_ops"),
      table.af.asc().nullsLast().op("bool_ops"),
      table.postedAt.asc().nullsLast().op("timestamptz_ops"),
    ),
    index("idx_posts_schemaVersion").using(
      "btree",
      table.schemaVersion.asc().nullsLast().op("float8_ops"),
    ),
    index("idx_posts_score").using(
      "btree",
      table.status.asc().nullsLast().op("bool_ops"),
      table.isFuture.asc().nullsLast().op("text_ops"),
      table.draft.asc().nullsLast().op("float8_ops"),
      table.unlisted.asc().nullsLast().op("float8_ops"),
      table.shortform.asc().nullsLast().op("float8_ops"),
      table.hiddenRelatedQuestion.asc().nullsLast().op("float8_ops"),
      table.authorIsUnreviewed.asc().nullsLast().op("timestamptz_ops"),
      table.groupId.asc().nullsLast().op("text_ops"),
      table.score.asc().nullsLast().op("bool_ops"),
      table.isEvent.asc().nullsLast().op("timestamptz_ops"),
      table.id.asc().nullsLast().op("timestamptz_ops"),
      table.meta.asc().nullsLast().op("timestamptz_ops"),
      table.af.asc().nullsLast().op("timestamptz_ops"),
      table.frontpageDate.asc().nullsLast().op("text_ops"),
      table.curatedDate.asc().nullsLast().op("text_ops"),
      table.postedAt.asc().nullsLast().op("text_ops"),
      table.baseScore.asc().nullsLast().op("timestamptz_ops"),
    ),
    index("idx_posts_slug").using(
      "btree",
      table.slug.asc().nullsLast().op("text_ops"),
    ),
    index("idx_posts_sort_by_topAdjusted")
      .using(
        "btree",
        table.status.asc().nullsLast().op("bool_ops"),
        table.isFuture.asc().nullsLast().op("timestamptz_ops"),
        table.draft.asc().nullsLast().op("timestamptz_ops"),
        table.unlisted.asc().nullsLast().op("timestamptz_ops"),
        table.shortform.asc().nullsLast().op("bool_ops"),
        table.hiddenRelatedQuestion.asc().nullsLast().op("bool_ops"),
        table.authorIsUnreviewed.asc().nullsLast().op("bool_ops"),
        table.groupId.asc().nullsLast().op("timestamptz_ops"),
        table.postedAt.asc().nullsLast().op("timestamptz_ops"),
        table.baseScore.asc().nullsLast().op("timestamptz_ops"),
        table.maxBaseScore.asc().nullsLast().op("timestamptz_ops"),
        table.id.asc().nullsLast().op("bool_ops"),
        table.meta.asc().nullsLast().op("bool_ops"),
        table.isEvent.asc().nullsLast().op("float8_ops"),
        table.af.asc().nullsLast().op("float8_ops"),
        table.frontpageDate.asc().nullsLast().op("text_ops"),
        table.curatedDate.asc().nullsLast().op("bool_ops"),
      )
      .where(
        sql`((status = (2)::double precision) AND (draft = false) AND (unlisted = false) AND ("isFuture" = false) AND (shortform = false) AND ("authorIsUnreviewed" = false) AND ("hiddenRelatedQuestion" = false) AND ("isEvent" = false))`,
      ),
    index("idx_posts_status_isFuture_draft_unlisted_authorIsUnreviewed_hid").using(
      "btree",
      table.status.asc().nullsLast().op("text_ops"),
      table.isFuture.asc().nullsLast().op("float8_ops"),
      table.draft.asc().nullsLast().op("bool_ops"),
      table.unlisted.asc().nullsLast().op("bool_ops"),
      table.authorIsUnreviewed.asc().nullsLast().op("float8_ops"),
      table.hideFrontpageComments.asc().nullsLast().op("bool_ops"),
      table.lastCommentedAt.asc().nullsLast().op("timestamptz_ops"),
      table.id.asc().nullsLast().op("float8_ops"),
      table.baseScore.asc().nullsLast().op("bool_ops"),
      table.af.asc().nullsLast().op("float8_ops"),
      table.isEvent.asc().nullsLast().op("float8_ops"),
      table.globalEvent.asc().nullsLast().op("float8_ops"),
      table.commentCount.asc().nullsLast().op("text_ops"),
    ),
    index("idx_posts_status_isFuture_draft_unlisted_shortform_hiddenRelate").using(
      "btree",
      table.status.asc().nullsLast().op("float8_ops"),
      table.isFuture.asc().nullsLast().op("bool_ops"),
      table.draft.asc().nullsLast().op("text_ops"),
      table.unlisted.asc().nullsLast().op("bool_ops"),
      table.shortform.asc().nullsLast().op("timestamptz_ops"),
      table.hiddenRelatedQuestion.asc().nullsLast().op("timestamptz_ops"),
      table.authorIsUnreviewed.asc().nullsLast().op("float8_ops"),
      table.groupId.asc().nullsLast().op("float8_ops"),
      table.rejected.asc().nullsLast().op("bool_ops"),
      table.postedAt.asc().nullsLast().op("text_ops"),
      table.id.asc().nullsLast().op("float8_ops"),
      table.meta.asc().nullsLast().op("timestamptz_ops"),
      table.isEvent.asc().nullsLast().op("timestamptz_ops"),
      table.af.asc().nullsLast().op("timestamptz_ops"),
      table.frontpageDate.asc().nullsLast().op("timestamptz_ops"),
      table.curatedDate.asc().nullsLast().op("timestamptz_ops"),
      table.baseScore.asc().nullsLast().op("timestamptz_ops"),
    ),
    index("idx_posts_sunshineCuratedSuggestions")
      .using(
        "gin",
        table.status.asc().nullsLast().op("bool_ops"),
        table.isFuture.asc().nullsLast().op("float8_ops"),
        table.draft.asc().nullsLast().op("float8_ops"),
        table.unlisted.asc().nullsLast().op("bool_ops"),
        table.shortform.asc().nullsLast().op("varchar_ops"),
        table.hiddenRelatedQuestion.asc().nullsLast().op("array_ops"),
        table.authorIsUnreviewed.asc().nullsLast().op("bool_ops"),
        table.groupId.asc().nullsLast().op("varchar_ops"),
        table.createdAt.asc().nullsLast().op("timestamptz_ops"),
        table.reviewForCuratedUserId.asc().nullsLast().op("bool_ops"),
        table.suggestForCuratedUserIds.asc().nullsLast().op("varchar_ops"),
        table.id.asc().nullsLast().op("timestamptz_ops"),
        table.meta.asc().nullsLast().op("timestamptz_ops"),
        table.isEvent.asc().nullsLast().op("timestamptz_ops"),
        table.af.asc().nullsLast().op("bool_ops"),
        table.frontpageDate.asc().nullsLast().op("bool_ops"),
        table.curatedDate.asc().nullsLast().op("bool_ops"),
        table.postedAt.asc().nullsLast().op("bool_ops"),
        table.baseScore.asc().nullsLast().op("float8_ops"),
      )
      .where(sql`("suggestForCuratedUserIds" IS NOT NULL)`),
    index("idx_posts_sunshineNewPosts").using(
      "btree",
      table.status.asc().nullsLast().op("text_ops"),
      table.isFuture.asc().nullsLast().op("timestamptz_ops"),
      table.draft.asc().nullsLast().op("text_ops"),
      table.unlisted.asc().nullsLast().op("bool_ops"),
      table.shortform.asc().nullsLast().op("bool_ops"),
      table.hiddenRelatedQuestion.asc().nullsLast().op("bool_ops"),
      table.authorIsUnreviewed.asc().nullsLast().op("bool_ops"),
      table.groupId.asc().nullsLast().op("text_ops"),
      table.reviewedByUserId.asc().nullsLast().op("float8_ops"),
      table.frontpageDate.asc().nullsLast().op("timestamptz_ops"),
      table.meta.asc().nullsLast().op("timestamptz_ops"),
      table.id.asc().nullsLast().op("text_ops"),
      table.isEvent.asc().nullsLast().op("float8_ops"),
      table.af.asc().nullsLast().op("float8_ops"),
      table.curatedDate.asc().nullsLast().op("float8_ops"),
      table.postedAt.asc().nullsLast().op("float8_ops"),
      table.baseScore.asc().nullsLast().op("bool_ops"),
    ),
    index("idx_posts_sunshineNewUsersPosts").using(
      "btree",
      table.status.asc().nullsLast().op("bool_ops"),
      table.isFuture.asc().nullsLast().op("float8_ops"),
      table.draft.asc().nullsLast().op("bool_ops"),
      table.unlisted.asc().nullsLast().op("bool_ops"),
      table.shortform.asc().nullsLast().op("bool_ops"),
      table.hiddenRelatedQuestion.asc().nullsLast().op("bool_ops"),
      table.authorIsUnreviewed.asc().nullsLast().op("float8_ops"),
      table.groupId.asc().nullsLast().op("bool_ops"),
      table.userId.asc().nullsLast().op("float8_ops"),
      table.hideAuthor.asc().nullsLast().op("float8_ops"),
      table.reviewedByUserId.asc().nullsLast().op("float8_ops"),
      table.frontpageDate.asc().nullsLast().op("float8_ops"),
      table.createdAt.asc().nullsLast().op("float8_ops"),
      table.id.asc().nullsLast().op("float8_ops"),
      table.meta.asc().nullsLast().op("text_ops"),
      table.isEvent.asc().nullsLast().op("timestamptz_ops"),
      table.af.asc().nullsLast().op("bool_ops"),
      table.curatedDate.asc().nullsLast().op("bool_ops"),
      table.postedAt.asc().nullsLast().op("bool_ops"),
      table.baseScore.asc().nullsLast().op("float8_ops"),
    ),
    index("idx_posts_tagRelevance__$**").using(
      "gin",
      sql`(("tagRelevance" -> '$**'::text))`,
    ),
    index("idx_posts_topQuestions").using(
      "btree",
      table.status.asc().nullsLast().op("text_ops"),
      table.isFuture.asc().nullsLast().op("text_ops"),
      table.draft.asc().nullsLast().op("bool_ops"),
      table.unlisted.asc().nullsLast().op("float8_ops"),
      table.shortform.asc().nullsLast().op("timestamptz_ops"),
      table.hiddenRelatedQuestion.asc().nullsLast().op("text_ops"),
      table.authorIsUnreviewed.asc().nullsLast().op("bool_ops"),
      table.groupId.asc().nullsLast().op("float8_ops"),
      table.question.asc().nullsLast().op("text_ops"),
      table.lastCommentedAt.asc().nullsLast().op("bool_ops"),
      table.id.asc().nullsLast().op("text_ops"),
      table.meta.asc().nullsLast().op("float8_ops"),
      table.isEvent.asc().nullsLast().op("bool_ops"),
      table.af.asc().nullsLast().op("float8_ops"),
      table.frontpageDate.asc().nullsLast().op("bool_ops"),
      table.curatedDate.asc().nullsLast().op("float8_ops"),
      table.postedAt.asc().nullsLast().op("bool_ops"),
      table.baseScore.asc().nullsLast().op("float8_ops"),
    ),
    index("idx_posts_url_postedAt").using(
      "btree",
      table.url.asc().nullsLast().op("text_ops"),
      table.postedAt.asc().nullsLast().op("text_ops"),
    ),
    index("idx_posts_userId_createdAt").using(
      "btree",
      table.status.asc().nullsLast().op("float8_ops"),
      table.isFuture.asc().nullsLast().op("float8_ops"),
      table.draft.asc().nullsLast().op("float8_ops"),
      table.unlisted.asc().nullsLast().op("float8_ops"),
      table.shortform.asc().nullsLast().op("float8_ops"),
      table.hiddenRelatedQuestion.asc().nullsLast().op("float8_ops"),
      table.authorIsUnreviewed.asc().nullsLast().op("float8_ops"),
      table.groupId.asc().nullsLast().op("float8_ops"),
      table.userId.asc().nullsLast().op("float8_ops"),
      table.hideAuthor.asc().nullsLast().op("float8_ops"),
      table.deletedDraft.asc().nullsLast().op("float8_ops"),
      table.modifiedAt.asc().nullsLast().op("timestamptz_ops"),
      table.createdAt.asc().nullsLast().op("timestamptz_ops"),
      table.id.asc().nullsLast().op("timestamptz_ops"),
      table.meta.asc().nullsLast().op("timestamptz_ops"),
      table.isEvent.asc().nullsLast().op("timestamptz_ops"),
      table.af.asc().nullsLast().op("timestamptz_ops"),
      table.frontpageDate.asc().nullsLast().op("timestamptz_ops"),
      table.curatedDate.asc().nullsLast().op("timestamptz_ops"),
      table.postedAt.asc().nullsLast().op("timestamptz_ops"),
      table.baseScore.asc().nullsLast().op("float8_ops"),
    ),
    index("idx_posts_userId_postedAt").using(
      "btree",
      table.userId.asc().nullsLast().op("text_ops"),
      table.postedAt.asc().nullsLast().op("text_ops"),
    ),
    index("idx_posts_userId_shareWithUsers").using(
      "gin",
      table.status.asc().nullsLast().op("timestamptz_ops"),
      table.isFuture.asc().nullsLast().op("timestamptz_ops"),
      table.draft.asc().nullsLast().op("timestamptz_ops"),
      table.unlisted.asc().nullsLast().op("timestamptz_ops"),
      table.shortform.asc().nullsLast().op("timestamptz_ops"),
      table.hiddenRelatedQuestion.asc().nullsLast().op("timestamptz_ops"),
      table.authorIsUnreviewed.asc().nullsLast().op("bool_ops"),
      table.groupId.asc().nullsLast().op("float8_ops"),
      table.shareWithUsers.asc().nullsLast().op("bool_ops"),
      table.deletedDraft.asc().nullsLast().op("timestamptz_ops"),
      table.modifiedAt.asc().nullsLast().op("timestamptz_ops"),
      table.createdAt.asc().nullsLast().op("timestamptz_ops"),
      table.id.asc().nullsLast().op("varchar_ops"),
      table.meta.asc().nullsLast().op("array_ops"),
      table.isEvent.asc().nullsLast().op("varchar_ops"),
      table.af.asc().nullsLast().op("varchar_ops"),
      table.frontpageDate.asc().nullsLast().op("varchar_ops"),
      table.curatedDate.asc().nullsLast().op("varchar_ops"),
      table.postedAt.asc().nullsLast().op("varchar_ops"),
      table.baseScore.asc().nullsLast().op("array_ops"),
    ),
  ],
);

export const reports = pgTable(
  "Reports",
  {
    ...universalFields,
    id: varchar("_id", { length: 27 }).primaryKey().notNull(),
    userId: varchar({ length: 27 }).notNull(),
    reportedUserId: varchar({ length: 27 }),
    commentId: varchar({ length: 27 }),
    postId: varchar({ length: 27 }),
    link: text().notNull(),
    claimedUserId: varchar({ length: 27 }),
    description: text(),
    closedAt: timestamp(),
    markedAsSpam: boolean(),
    reportedAsSpam: boolean(),
  },
  (table) => [
    index("idx_Reports_claimedUserId_createdAt").using(
      "btree",
      table.claimedUserId.asc().nullsLast().op("text_ops"),
      table.createdAt.asc().nullsLast().op("text_ops"),
    ),
    index("idx_Reports_closedAt_createdAt").using(
      "btree",
      table.closedAt.asc().nullsLast().op("timestamptz_ops"),
      table.createdAt.asc().nullsLast().op("timestamptz_ops"),
    ),
    index("idx_Reports_createdAt").using(
      "btree",
      table.createdAt.asc().nullsLast().op("timestamptz_ops"),
    ),
    index("idx_Reports_schemaVersion").using(
      "btree",
      table.schemaVersion.asc().nullsLast().op("float8_ops"),
    ),
  ],
);

export const rssFeeds = pgTable(
  "RSSFeeds",
  {
    ...universalFields,
    id: varchar("_id", { length: 27 }).primaryKey().notNull(),
    userId: varchar({ length: 27 }).notNull(),
    ownedByUser: boolean().default(false).notNull(),
    displayFullContent: boolean().default(false).notNull(),
    nickname: text().notNull(),
    url: text().notNull(),
    status: text(),
    rawFeed: jsonb().notNull(),
    setCanonicalUrl: boolean().default(false).notNull(),
    importAsDraft: boolean().default(false).notNull(),
  },
  (table) => [
    index("idx_RSSFeeds_schemaVersion").using(
      "btree",
      table.schemaVersion.asc().nullsLast().op("float8_ops"),
    ),
    index("idx_RSSFeeds_userId_createdAt").using(
      "btree",
      table.userId.asc().nullsLast().op("text_ops"),
      table.createdAt.asc().nullsLast().op("text_ops"),
    ),
  ],
);

export const tagRels = pgTable(
  "TagRels",
  {
    ...universalFields,
    id: varchar("_id", { length: 27 }).primaryKey().notNull(),
    tagId: varchar({ length: 27 }).notNull(),
    postId: varchar({ length: 27 }).notNull(),
    deleted: boolean().default(false).notNull(),
    userId: varchar({ length: 27 }),
    voteCount: doublePrecision().default(0).notNull(),
    baseScore: doublePrecision().default(0).notNull(),
    extendedScore: jsonb(),
    score: doublePrecision().default(0).notNull(),
    inactive: boolean().default(false).notNull(),
    afBaseScore: doublePrecision(),
    afExtendedScore: jsonb(),
    afVoteCount: doublePrecision(),
    backfilled: boolean().default(false).notNull(),
  },
  (table) => [
    index("idx_TagRels_postId").using(
      "btree",
      table.postId.asc().nullsLast().op("text_ops"),
    ),
    index("idx_TagRels_schemaVersion").using(
      "btree",
      table.schemaVersion.asc().nullsLast().op("float8_ops"),
    ),
    index("idx_TagRels_tagId").using(
      "btree",
      table.tagId.asc().nullsLast().op("text_ops"),
    ),
  ],
);

export const subscriptions = pgTable(
  "Subscriptions",
  {
    ...universalFields,
    id: varchar("_id", { length: 27 }).primaryKey().notNull(),
    userId: varchar({ length: 27 }).notNull(),
    state: text().notNull(),
    documentId: text(),
    collectionName: text().notNull(),
    deleted: boolean().default(false).notNull(),
    type: text().notNull(),
  },
  (table) => [
    index("idx_Subscriptions_schemaVersion").using(
      "btree",
      table.schemaVersion.asc().nullsLast().op("float8_ops"),
    ),
    index("idx_Subscriptions_userId_documentId_collectionName_type_created").using(
      "btree",
      table.userId.asc().nullsLast().op("text_ops"),
      table.documentId.asc().nullsLast().op("text_ops"),
      table.collectionName.asc().nullsLast().op("text_ops"),
      table.type.asc().nullsLast().op("text_ops"),
      table.createdAt.asc().nullsLast().op("text_ops"),
    ),
  ],
);

export const readStatuses = pgTable(
  "ReadStatuses",
  {
    ...universalFields,
    id: varchar("_id", { length: 27 }).primaryKey().notNull(),
    postId: varchar({ length: 27 }),
    tagId: varchar({ length: 27 }),
    userId: varchar({ length: 27 }).notNull(),
    isRead: boolean().notNull(),
    lastUpdated: timestamp().notNull(),
  },
  (table) => [
    index("idx_ReadStatuses_schemaVersion").using(
      "btree",
      table.schemaVersion.asc().nullsLast().op("float8_ops"),
    ),
    index("idx_ReadStatuses_userId_postId_isRead_lastUpdated").using(
      "btree",
      table.userId.asc().nullsLast().op("text_ops"),
      table.postId.asc().nullsLast().op("text_ops"),
      table.isRead.asc().nullsLast().op("text_ops"),
      table.lastUpdated.asc().nullsLast().op("text_ops"),
    ),
    uniqueIndex("idx_ReadStatuses_userId_postId_tagId").using(
      "btree",
      sql`COALESCE("userId", ''::character varying)`,
      sql`COALESCE("postId", ''::character varying)`,
      sql`COALESCE("tagId", ''::character varying)`,
    ),
    index("idx_ReadStatuses_userId_tagId_isRead_lastUpdated").using(
      "btree",
      table.userId.asc().nullsLast().op("text_ops"),
      table.tagId.asc().nullsLast().op("text_ops"),
      table.isRead.asc().nullsLast().op("text_ops"),
      table.lastUpdated.asc().nullsLast().op("text_ops"),
    ),
  ],
);

export const sessions = pgTable(
  "Sessions",
  {
    id: text("_id").primaryKey().notNull(),
    session: jsonb(),
    expires: timestamp(),
    lastModified: timestamp(),
  },
  (table) => [
    index("idx_Sessions__id_expires").using(
      "btree",
      table.id.asc().nullsLast().op("text_ops"),
      table.expires.asc().nullsLast().op("text_ops"),
    ),
    index("idx_Sessions_expires").using(
      "btree",
      table.expires.asc().nullsLast().op("timestamptz_ops"),
    ),
  ],
);

export const tagFlags = pgTable(
  "TagFlags",
  {
    ...universalFields,
    id: varchar("_id", { length: 27 }).primaryKey().notNull(),
    name: text().notNull(),
    deleted: boolean().default(false).notNull(),
    slug: text().notNull(),
    order: doublePrecision(),
    contents: jsonb(),
    contentsLatest: text("contents_latest"),
  },
  (table) => [
    index("idx_TagFlags_deleted_order_name").using(
      "btree",
      table.deleted.asc().nullsLast().op("float8_ops"),
      table.order.asc().nullsLast().op("float8_ops"),
      table.name.asc().nullsLast().op("float8_ops"),
    ),
    index("idx_TagFlags_schemaVersion").using(
      "btree",
      table.schemaVersion.asc().nullsLast().op("float8_ops"),
    ),
  ],
);

export const revisions = pgTable(
  "Revisions",
  {
    ...universalFields,
    id: varchar("_id", { length: 27 }).primaryKey().notNull(),
    documentId: text(),
    collectionName: text(),
    fieldName: text(),
    editedAt: timestamp(),
    autosaveTimeoutStart: timestamp(),
    updateType: text(),
    version: text().notNull(),
    commitMessage: text(),
    userId: varchar({ length: 27 }),
    draft: boolean(),
    originalContents: jsonb(),
    html: text(),
    wordCount: doublePrecision().notNull(),
    changeMetrics: jsonb().notNull(),
    voteCount: doublePrecision().default(0).notNull(),
    baseScore: doublePrecision().default(0).notNull(),
    extendedScore: jsonb(),
    score: doublePrecision().default(0).notNull(),
    afBaseScore: doublePrecision(),
    afExtendedScore: jsonb(),
    afVoteCount: doublePrecision(),
    googleDocMetadata: jsonb(),
    skipAttributions: boolean().default(false).notNull(),
  },
  (table) => [
    index("idx_Revisions_collectionName_fieldName_editedAt__id_changeMetri").using(
      "btree",
      table.collectionName.asc().nullsLast().op("text_ops"),
      table.fieldName.asc().nullsLast().op("text_ops"),
      table.editedAt.asc().nullsLast().op("text_ops"),
      table.id.asc().nullsLast().op("text_ops"),
      table.changeMetrics.asc().nullsLast().op("text_ops"),
    ),
    index("idx_Revisions_documentId_version_fieldName_editedAt").using(
      "btree",
      table.documentId.asc().nullsLast().op("text_ops"),
      table.version.asc().nullsLast().op("text_ops"),
      table.fieldName.asc().nullsLast().op("text_ops"),
      table.editedAt.asc().nullsLast().op("text_ops"),
    ),
    index("idx_Revisions_schemaVersion").using(
      "btree",
      table.schemaVersion.asc().nullsLast().op("float8_ops"),
    ),
    index("idx_Revisions_userId_collectionName_editedAt").using(
      "btree",
      table.userId.asc().nullsLast().op("text_ops"),
      table.collectionName.asc().nullsLast().op("text_ops"),
      table.editedAt.asc().nullsLast().op("text_ops"),
    ),
  ],
);

export const sequences = pgTable(
  "Sequences",
  {
    ...universalFields,
    id: varchar("_id", { length: 27 }).primaryKey().notNull(),
    userId: varchar({ length: 27 }).notNull(),
    title: text().notNull(),
    gridImageId: text(),
    bannerImageId: text(),
    curatedOrder: doublePrecision(),
    userProfileOrder: doublePrecision(),
    draft: boolean().default(false).notNull(),
    isDeleted: boolean().default(false).notNull(),
    canonicalCollectionSlug: text(),
    hidden: boolean().default(false).notNull(),
    hideFromAuthorPage: boolean().default(false).notNull(),
    af: boolean().default(false).notNull(),
    contents: jsonb(),
    contentsLatest: text("contents_latest"),
    noindex: boolean().default(false).notNull(),
    lastUpdated: timestamp().notNull(),
  },
  (table) => [
    index("idx_Sequences_hidden_af_isDeleted_curatedOrder").using(
      "btree",
      table.hidden.asc().nullsLast().op("float8_ops"),
      table.af.asc().nullsLast().op("float8_ops"),
      table.isDeleted.asc().nullsLast().op("float8_ops"),
      table.curatedOrder.asc().nullsLast().op("float8_ops"),
    ),
    index("idx_Sequences_hidden_af_isDeleted_userId_draft_hideFromAuthorPa").using(
      "btree",
      table.hidden.asc().nullsLast().op("float8_ops"),
      table.af.asc().nullsLast().op("float8_ops"),
      table.isDeleted.asc().nullsLast().op("float8_ops"),
      table.userId.asc().nullsLast().op("float8_ops"),
      table.draft.asc().nullsLast().op("float8_ops"),
      table.hideFromAuthorPage.asc().nullsLast().op("float8_ops"),
      table.userProfileOrder.asc().nullsLast().op("float8_ops"),
    ),
    index("idx_Sequences_hidden_af_isDeleted_userId_userProfileOrder").using(
      "btree",
      table.hidden.asc().nullsLast().op("float8_ops"),
      table.af.asc().nullsLast().op("float8_ops"),
      table.isDeleted.asc().nullsLast().op("float8_ops"),
      table.userId.asc().nullsLast().op("float8_ops"),
      table.userProfileOrder.asc().nullsLast().op("float8_ops"),
    ),
    index("idx_Sequences_schemaVersion").using(
      "btree",
      table.schemaVersion.asc().nullsLast().op("float8_ops"),
    ),
  ],
);

export const spotlights = pgTable(
  "Spotlights",
  {
    ...universalFields,
    id: varchar("_id", { length: 27 }).primaryKey().notNull(),
    documentId: text().notNull(),
    documentType: text().default("Sequence").notNull(),
    position: doublePrecision().notNull(),
    duration: doublePrecision().default(3).notNull(),
    customTitle: text(),
    customSubtitle: text(),
    lastPromotedAt: timestamp().default("1970-01-01 00:00:00+00").notNull(),
    draft: boolean().default(true).notNull(),
    spotlightImageId: text(),
    descriptionLatest: text("description_latest"),
    description: jsonb(),
    showAuthor: boolean().default(false).notNull(),
    spotlightDarkImageId: text(),
    imageFade: boolean().default(true).notNull(),
    headerTitle: text(),
    headerTitleLeftColor: text(),
    headerTitleRightColor: text(),
    imageFadeColor: text(),
    deletedDraft: boolean().default(false).notNull(),
    spotlightSplashImageUrl: text(),
    subtitleUrl: text(),
  },
  (table) => [
    index("idx_Spotlights_lastPromotedAt").using(
      "btree",
      table.lastPromotedAt.asc().nullsLast().op("timestamptz_ops"),
    ),
    index("idx_Spotlights_position").using(
      "btree",
      table.position.asc().nullsLast().op("float8_ops"),
    ),
    index("idx_Spotlights_schemaVersion").using(
      "btree",
      table.schemaVersion.asc().nullsLast().op("float8_ops"),
    ),
  ],
);

export const userEagDetails = pgTable(
  "UserEAGDetails",
  {
    ...universalFields,
    id: varchar("_id", { length: 27 }).primaryKey().notNull(),
    userId: varchar({ length: 27 }).notNull(),
    careerStage: text().array(),
    countryOrRegion: text(),
    nearestCity: text(),
    willingnessToRelocate: jsonb(),
    experiencedIn: text().array(),
    interestedIn: text().array(),
    lastUpdated: timestamp().notNull(),
  },
  (table) => [
    index("idx_UserEAGDetails_schemaVersion").using(
      "btree",
      table.schemaVersion.asc().nullsLast().op("float8_ops"),
    ),
    uniqueIndex("idx_UserEAGDetails_userId").using(
      "btree",
      table.userId.asc().nullsLast().op("text_ops"),
    ),
  ],
);

export const tweets = pgTable(
  "Tweets",
  {
    ...universalFields,
    id: varchar("_id", { length: 27 }).primaryKey().notNull(),
    postId: text().notNull(),
    tweetId: text().notNull(),
    content: text().notNull(),
  },
  (table) => [
    index("idx_Tweets_postId").using(
      "btree",
      table.postId.asc().nullsLast().op("text_ops"),
    ),
    index("idx_Tweets_schemaVersion").using(
      "btree",
      table.schemaVersion.asc().nullsLast().op("float8_ops"),
    ),
    index("idx_Tweets_tweetId").using(
      "btree",
      table.tweetId.asc().nullsLast().op("text_ops"),
    ),
  ],
);

export const userJobAds = pgTable(
  "UserJobAds",
  {
    ...universalFields,
    id: varchar("_id", { length: 27 }).primaryKey().notNull(),
    userId: varchar({ length: 27 }).notNull(),
    jobName: text().notNull(),
    adState: text().notNull(),
    lastUpdated: timestamp().notNull(),
    reminderSetAt: timestamp(),
  },
  (table) => [
    index("idx_UserJobAds_jobName_adState").using(
      "btree",
      table.jobName.asc().nullsLast().op("text_ops"),
      table.adState.asc().nullsLast().op("text_ops"),
    ),
    index("idx_UserJobAds_schemaVersion").using(
      "btree",
      table.schemaVersion.asc().nullsLast().op("float8_ops"),
    ),
    index("idx_UserJobAds_userId").using(
      "btree",
      table.userId.asc().nullsLast().op("text_ops"),
    ),
    uniqueIndex("idx_UserJobAds_userId_jobName").using(
      "btree",
      table.userId.asc().nullsLast().op("text_ops"),
      table.jobName.asc().nullsLast().op("text_ops"),
    ),
  ],
);

export const userActivities = pgTable(
  "UserActivities",
  {
    ...universalFields,
    id: varchar("_id", { length: 27 }).primaryKey().notNull(),
    visitorId: varchar({ length: 27 }).notNull(),
    type: text().notNull(),
    startDate: timestamp().notNull(),
    endDate: timestamp().notNull(),
    activityArray: doublePrecision().array().notNull(),
  },
  (table) => [
    index("idx_UserActivities_schemaVersion").using(
      "btree",
      table.schemaVersion.asc().nullsLast().op("float8_ops"),
    ),
    index("idx_UserActivities_visitorId_type").using(
      "btree",
      table.visitorId.asc().nullsLast().op("text_ops"),
      table.type.asc().nullsLast().op("text_ops"),
    ),
    unique("UserActivities_visitorId_type_key").on(table.visitorId, table.type),
  ],
);

export const userRateLimits = pgTable(
  "UserRateLimits",
  {
    ...universalFields,
    id: varchar("_id", { length: 27 }).primaryKey().notNull(),
    userId: varchar({ length: 27 }).notNull(),
    type: text().notNull(),
    intervalUnit: text().notNull(),
    intervalLength: doublePrecision().notNull(),
    actionsPerInterval: doublePrecision().notNull(),
    endedAt: timestamp().notNull(),
  },
  (table) => [
    index("idx_UserRateLimits_schemaVersion").using(
      "btree",
      table.schemaVersion.asc().nullsLast().op("float8_ops"),
    ),
    index("idx_UserRateLimits_userId_createdAt_endedAt").using(
      "btree",
      table.userId.asc().nullsLast().op("text_ops"),
      table.createdAt.asc().nullsLast().op("text_ops"),
      table.endedAt.asc().nullsLast().op("text_ops"),
    ),
  ],
);

export const userTagRels = pgTable(
  "UserTagRels",
  {
    ...universalFields,
    id: varchar("_id", { length: 27 }).primaryKey().notNull(),
    tagId: varchar({ length: 27 }).notNull(),
    userId: varchar({ length: 27 }).notNull(),
    subforumLastVisitedAt: timestamp(),
    subforumShowUnreadInSidebar: boolean().default(true).notNull(),
    subforumEmailNotifications: boolean().default(false).notNull(),
    subforumHideIntroPost: boolean().default(false).notNull(),
  },
  (table) => [
    index("idx_UserTagRels_schemaVersion").using(
      "btree",
      table.schemaVersion.asc().nullsLast().op("float8_ops"),
    ),
    uniqueIndex("idx_UserTagRels_tagId_userId").using(
      "btree",
      sql`COALESCE("tagId", ''::character varying)`,
      sql`COALESCE("userId", ''::character varying)`,
    ),
  ],
);

export const userMostValuablePosts = pgTable(
  "UserMostValuablePosts",
  {
    ...universalFields,
    id: varchar("_id", { length: 27 }).primaryKey().notNull(),
    userId: varchar({ length: 27 }).notNull(),
    postId: varchar({ length: 27 }).notNull(),
    deleted: boolean().default(false).notNull(),
  },
  (table) => [
    index("idx_UserMostValuablePosts_schemaVersion").using(
      "btree",
      table.schemaVersion.asc().nullsLast().op("float8_ops"),
    ),
    index("idx_UserMostValuablePosts_userId").using(
      "btree",
      table.userId.asc().nullsLast().op("text_ops"),
    ),
    index("idx_UserMostValuablePosts_userId_deleted").using(
      "btree",
      table.userId.asc().nullsLast().op("text_ops"),
      table.deleted.asc().nullsLast().op("text_ops"),
    ),
    index("idx_UserMostValuablePosts_userId_postId").using(
      "btree",
      table.userId.asc().nullsLast().op("text_ops"),
      table.postId.asc().nullsLast().op("text_ops"),
    ),
    index("idx_UserMostValuablePosts_userId_postId_deleted").using(
      "btree",
      table.userId.asc().nullsLast().op("text_ops"),
      table.postId.asc().nullsLast().op("text_ops"),
      table.deleted.asc().nullsLast().op("text_ops"),
    ),
  ],
);

export const tags = pgTable(
  "Tags",
  {
    ...universalFields,
    id: varchar("_id", { length: 27 }).primaryKey().notNull(),
    name: text().notNull(),
    slug: text().notNull(),
    oldSlugs: text().array().default([""]).notNull(),
    core: boolean().default(false).notNull(),
    suggestedAsFilter: boolean().default(false).notNull(),
    defaultOrder: doublePrecision().default(0).notNull(),
    descriptionTruncationCount: doublePrecision().default(0).notNull(),
    postCount: doublePrecision().default(0).notNull(),
    userId: varchar({ length: 27 }),
    adminOnly: boolean().default(false).notNull(),
    canEditUserIds: varchar({ length: 27 }).array(),
    charsAdded: doublePrecision(),
    charsRemoved: doublePrecision(),
    deleted: boolean().default(false).notNull(),
    lastCommentedAt: timestamp(),
    lastSubforumCommentAt: timestamp(),
    needsReview: boolean().default(true).notNull(),
    reviewedByUserId: varchar({ length: 27 }),
    wikiGrade: integer().default(2).notNull(),
    wikiOnly: boolean().default(false).notNull(),
    bannerImageId: text(),
    tagFlagsIds: varchar({ length: 27 })
      .array()
      .default(["}'::character varying(2"])
      .notNull(),
    lesswrongWikiImportRevision: text(),
    lesswrongWikiImportSlug: text(),
    lesswrongWikiImportCompleted: boolean(),
    htmlWithContributorAnnotations: text(),
    contributionStats: jsonb(),
    introSequenceId: varchar({ length: 27 }),
    postsDefaultSortOrder: text(),
    canVoteOnRels: text().array(),
    isSubforum: boolean().default(false).notNull(),
    subforumModeratorIds: varchar({ length: 27 })
      .array()
      .default(["}'::character varying(2"])
      .notNull(),
    parentTagId: varchar({ length: 27 }),
    autoTagModel: text(),
    autoTagPrompt: text(),
    descriptionLatest: text("description_latest"),
    subforumWelcomeTextLatest: text("subforumWelcomeText_latest"),
    moderationGuidelines: jsonb(),
    moderationGuidelinesLatest: text("moderationGuidelines_latest"),
    description: jsonb(),
    subforumWelcomeText: jsonb(),
    subTagIds: varchar({ length: 27 })
      .array()
      .default(["}'::character varying(2"])
      .notNull(),
    subforumIntroPostId: varchar({ length: 27 }),
    shortName: text(),
    squareImageId: text(),
    subtitle: text(),
    noindex: boolean().default(false).notNull(),
    isPostType: boolean().default(false).notNull(),
    isPlaceholderPage: boolean().default(false).notNull(),
    pingbacks: jsonb(),
    voteCount: doublePrecision().default(0).notNull(),
    score: doublePrecision().default(0).notNull(),
    baseScore: doublePrecision().default(0).notNull(),
    extendedScore: jsonb(),
    inactive: boolean().default(false).notNull(),
    afBaseScore: doublePrecision(),
    afExtendedScore: jsonb(),
    afVoteCount: doublePrecision(),
    coreTagId: text(),
    forceAllowType3Audio: boolean().default(false).notNull(),
  },
  (table) => [
    index("idx_Tags_deleted_adminOnly").using(
      "btree",
      table.deleted.asc().nullsLast().op("bool_ops"),
      table.adminOnly.asc().nullsLast().op("bool_ops"),
    ),
    index("idx_Tags_deleted_adminOnly_lesswrongWikiImportSlug").using(
      "btree",
      table.deleted.asc().nullsLast().op("text_ops"),
      table.adminOnly.asc().nullsLast().op("text_ops"),
      table.lesswrongWikiImportSlug.asc().nullsLast().op("text_ops"),
    ),
    index("idx_Tags_deleted_adminOnly_name").using(
      "btree",
      table.deleted.asc().nullsLast().op("text_ops"),
      table.adminOnly.asc().nullsLast().op("bool_ops"),
      table.name.asc().nullsLast().op("text_ops"),
    ),
    index("idx_Tags_deleted_adminOnly_suggestedAsFilter_defaultOrder_name").using(
      "btree",
      table.deleted.asc().nullsLast().op("float8_ops"),
      table.adminOnly.asc().nullsLast().op("float8_ops"),
      table.suggestedAsFilter.asc().nullsLast().op("float8_ops"),
      table.defaultOrder.asc().nullsLast().op("bool_ops"),
      table.name.asc().nullsLast().op("float8_ops"),
    ),
    index("idx_Tags_deleted_adminOnly_tagFlagsIds").using(
      "gin",
      table.deleted.asc().nullsLast().op("array_ops"),
      table.adminOnly.asc().nullsLast().op("array_ops"),
      table.tagFlagsIds.asc().nullsLast().op("array_ops"),
    ),
    index("idx_Tags_deleted_adminOnly_wikiGrade_defaultOrder_postCount_nam").using(
      "btree",
      table.deleted.asc().nullsLast().op("int4_ops"),
      table.adminOnly.asc().nullsLast().op("int4_ops"),
      table.wikiGrade.asc().nullsLast().op("int4_ops"),
      table.defaultOrder.asc().nullsLast().op("int4_ops"),
      table.postCount.asc().nullsLast().op("bool_ops"),
      table.name.asc().nullsLast().op("int4_ops"),
    ),
    index("idx_Tags_deleted_adminOnly_wikiOnly_createdAt").using(
      "btree",
      table.deleted.asc().nullsLast().op("timestamptz_ops"),
      table.adminOnly.asc().nullsLast().op("timestamptz_ops"),
      table.wikiOnly.asc().nullsLast().op("timestamptz_ops"),
      table.createdAt.asc().nullsLast().op("timestamptz_ops"),
    ),
    index("idx_Tags_deleted_core_name").using(
      "btree",
      table.deleted.asc().nullsLast().op("text_ops"),
      table.core.asc().nullsLast().op("text_ops"),
      table.name.asc().nullsLast().op("text_ops"),
    ),
    index("idx_Tags_deleted_createdAt").using(
      "btree",
      table.deleted.asc().nullsLast().op("timestamptz_ops"),
      table.createdAt.asc().nullsLast().op("timestamptz_ops"),
    ),
    index("idx_Tags_deleted_isPostType_name").using(
      "btree",
      table.deleted.asc().nullsLast().op("bool_ops"),
      table.isPostType.asc().nullsLast().op("bool_ops"),
      table.name.asc().nullsLast().op("bool_ops"),
    ),
    index("idx_Tags_deleted_needsReview_createdAt").using(
      "btree",
      table.deleted.asc().nullsLast().op("bool_ops"),
      table.needsReview.asc().nullsLast().op("timestamptz_ops"),
      table.createdAt.asc().nullsLast().op("bool_ops"),
    ),
    index("idx_Tags_deleted_slug_oldSlugs").using(
      "gin",
      table.deleted.asc().nullsLast().op("array_ops"),
      table.slug.asc().nullsLast().op("array_ops"),
      table.oldSlugs.asc().nullsLast().op("array_ops"),
    ),
    index("idx_Tags_deleted_userId_createdAt").using(
      "btree",
      table.deleted.asc().nullsLast().op("bool_ops"),
      table.userId.asc().nullsLast().op("bool_ops"),
      table.createdAt.asc().nullsLast().op("text_ops"),
    ),
    index("idx_Tags_name").using(
      "btree",
      table.name.asc().nullsLast().op("text_ops"),
    ),
    index("idx_Tags_parentTagId").using(
      "btree",
      table.parentTagId.asc().nullsLast().op("text_ops"),
    ),
    index("idx_Tags_schemaVersion").using(
      "btree",
      table.schemaVersion.asc().nullsLast().op("float8_ops"),
    ),
  ],
);

export const votes = pgTable(
  "Votes",
  {
    ...universalFields,
    id: varchar("_id", { length: 27 }).primaryKey().notNull(),
    documentId: text().notNull(),
    collectionName: text().notNull(),
    userId: varchar({ length: 27 }).notNull(),
    authorIds: varchar({ length: 27 }).array(),
    voteType: text().notNull(),
    extendedVoteType: jsonb(),
    power: doublePrecision().notNull(),
    afPower: doublePrecision(),
    cancelled: boolean().default(false).notNull(),
    isUnvote: boolean().default(false).notNull(),
    votedAt: timestamp().notNull(),
    documentIsAf: boolean().default(false).notNull(),
    silenceNotification: boolean().default(false).notNull(),
  },
  (table) => [
    index("idx_Votes_authorIds").using(
      "gin",
      table.authorIds.asc().nullsLast().op("array_ops"),
    ),
    index("idx_Votes_authorIds_votedAt_userId_afPower").using(
      "gin",
      table.authorIds.asc().nullsLast().op("varchar_ops"),
      table.votedAt.asc().nullsLast().op("varchar_ops"),
      table.userId.asc().nullsLast().op("float8_ops"),
      table.afPower.asc().nullsLast().op("varchar_ops"),
    ),
    index("idx_Votes_cancelled_documentId").using(
      "btree",
      table.cancelled.asc().nullsLast().op("bool_ops"),
      table.documentId.asc().nullsLast().op("bool_ops"),
    ),
    index("idx_Votes_cancelled_userId_documentId").using(
      "btree",
      table.cancelled.asc().nullsLast().op("bool_ops"),
      table.userId.asc().nullsLast().op("bool_ops"),
      table.documentId.asc().nullsLast().op("bool_ops"),
    ),
    index("idx_Votes_cancelled_userId_votedAt").using(
      "btree",
      table.cancelled.asc().nullsLast().op("text_ops"),
      table.userId.asc().nullsLast().op("bool_ops"),
      table.votedAt.asc().nullsLast().op("bool_ops"),
    ),
    index("idx_Votes_collectionName_userId_voteType_cancelled_isUnvote_vot").using(
      "btree",
      table.collectionName.asc().nullsLast().op("timestamptz_ops"),
      table.userId.asc().nullsLast().op("text_ops"),
      table.voteType.asc().nullsLast().op("bool_ops"),
      table.cancelled.asc().nullsLast().op("text_ops"),
      table.isUnvote.asc().nullsLast().op("timestamptz_ops"),
      table.votedAt.asc().nullsLast().op("timestamptz_ops"),
    ),
    index("idx_Votes_collectionName_votedAt").using(
      "btree",
      table.collectionName.asc().nullsLast().op("timestamptz_ops"),
      table.votedAt.asc().nullsLast().op("timestamptz_ops"),
    ),
    index("idx_Votes_documentId").using(
      "btree",
      table.documentId.asc().nullsLast().op("text_ops"),
    ),
    index("idx_Votes_schemaVersion").using(
      "btree",
      table.schemaVersion.asc().nullsLast().op("float8_ops"),
    ),
    index("idx_Votes_userId_cancelled_votedAt").using(
      "btree",
      table.userId.asc().nullsLast().op("text_ops"),
      table.cancelled.asc().nullsLast().op("bool_ops"),
      table.votedAt.asc().nullsLast().op("bool_ops"),
    ),
    index("idx_votes_authorIds").using(
      "gin",
      table.authorIds.asc().nullsLast().op("array_ops"),
    ),
    index("idx_votes_cancelled_documentId").using(
      "btree",
      table.cancelled.asc().nullsLast().op("text_ops"),
      table.documentId.asc().nullsLast().op("bool_ops"),
    ),
    index("idx_votes_cancelled_userId_documentId").using(
      "btree",
      table.cancelled.asc().nullsLast().op("bool_ops"),
      table.userId.asc().nullsLast().op("text_ops"),
      table.documentId.asc().nullsLast().op("text_ops"),
    ),
    index("idx_votes_cancelled_userId_votedAt").using(
      "btree",
      table.cancelled.asc().nullsLast().op("timestamptz_ops"),
      table.userId.asc().nullsLast().op("timestamptz_ops"),
      table.votedAt.asc().nullsLast().op("text_ops"),
    ),
    index("idx_votes_collectionName_userId_voteType_cancelled_isUnvote_vot").using(
      "btree",
      table.collectionName.asc().nullsLast().op("timestamptz_ops"),
      table.userId.asc().nullsLast().op("text_ops"),
      table.voteType.asc().nullsLast().op("text_ops"),
      table.cancelled.asc().nullsLast().op("bool_ops"),
      table.isUnvote.asc().nullsLast().op("bool_ops"),
      table.votedAt.asc().nullsLast().op("text_ops"),
    ),
    index("idx_votes_collectionName_votedAt").using(
      "btree",
      table.collectionName.asc().nullsLast().op("timestamptz_ops"),
      table.votedAt.asc().nullsLast().op("timestamptz_ops"),
    ),
    index("idx_votes_documentId").using(
      "btree",
      table.documentId.asc().nullsLast().op("text_ops"),
    ),
    index("idx_votes_schemaVersion").using(
      "btree",
      table.schemaVersion.asc().nullsLast().op("float8_ops"),
    ),
    index("idx_votes_userId_cancelled_votedAt").using(
      "btree",
      table.userId.asc().nullsLast().op("bool_ops"),
      table.cancelled.asc().nullsLast().op("bool_ops"),
      table.votedAt.asc().nullsLast().op("timestamptz_ops"),
    ),
    index("idx_votes_userId_collectionName_cancelled_votedAt").using(
      "btree",
      table.userId.asc().nullsLast().op("bool_ops"),
      table.collectionName.asc().nullsLast().op("bool_ops"),
      table.cancelled.asc().nullsLast().op("bool_ops"),
      table.votedAt.asc().nullsLast().op("text_ops"),
    ),
  ],
);
